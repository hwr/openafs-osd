<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    -->
<BODY bgcolor="ffffff">
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRFS_MKMOUNT" HREF="auarf002.htm#ToC_167">fs mkmount</A></H2>
<A NAME="IDX4893"></A>
<A NAME="IDX4894"></A>
<A NAME="IDX4895"></A>
<A NAME="IDX4896"></A>
<A NAME="IDX4897"></A>
<P><STRONG>目的</STRONG>
<P>ボリュームにマウント・ポイントを作成します。
<P><STRONG>構文</STRONG>
<PRE><B>fs mkmount -dir</B> &lt;<VAR>directory</VAR>>  <B>-vol</B> &lt;<VAR>volume name</VAR>>  [<B>-cell</B> &lt;<VAR>cell name</VAR>>]
           [<B>-rw</B>]  [<B>-fast</B>]  [<B>-help</B>]

<B>fs mk -d</B> &lt;<VAR>directory</VAR>>  <B>-v</B> &lt;<VAR>volume name</VAR>>  [<B>-c</B> &lt;<VAR>cell name</VAR>>]  [<B>-r</B>]  [<B>-f</B>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>fs mkmount</B> コマンドは、<B>-vol</B> 引き数によって指定されたボリュームのマウント・ポイントを、<B>-dir</B> 引き数によって指定された AFS ファイル・スペースに作成します。マウント・ポイントは、標準のディレクトリー要素に似ていて、ボリュームのルート・ディレクトリーのように機能しますが、実際には AFS ボリュームを参照する特殊ファイルのシステム・オブジェクトです。キャッシュ・マネージャーはパス名の走査中に与えられたマウント・ポイントに初めて検出したとき、VL サーバーに接続し、どのファイル・サーバーに指示されたボリュームが格納されているのか確認して、適切なファイル・サーバー・マシンからボリュームのルート・ディレクトリーのコピーを取り出します。
<P>推奨されてはいませんが、1 つのボリュームに複数のマウント・ポイントを作成することもできます。ファイル・スペースを通して同じパスに沿った
2 箇所にボリュームをマウントすると、キャッシュ・マネージャーが混乱することがあります。
<P>キャッシュ・マネージャーは、AFS ファイル・スペースを通り抜けてマウント・ポイントに出会ったときに、以下の 3 つの基本規則を監視します。
<UL>
<LI><B>規則 1:</B> 指定された場合に、バックアップ・ボリュームおよび読み取り専用ボリュームにアクセスする。
<P>
<P>キャッシュ・マネージャーが、
<B>.readonly</B> または <B>.backup</B> の拡張子いずれかをもつボリュームを指定するマウント・ポイントに出会うと、そのタイプのボリュームだけにアクセスします。
<B>.backup</B> または
<B>.readonly</B> の拡張子のいずれもマウント・ポイントにない場合には、キャッシュ・マネージャーは規則 2 または規則 3 を使用します。
<P>
<P>たとえば、キャッシュ・マネージャーは、マウント・ポイントがバックアップ・バージョンを指定している場合には、読み取り / 書き込みバージョンのボリュームにアクセスすることはありません。指定されたバージョンがアクセス不能の場合には、キャッシュ・マネージャーはエラーを報告します。
</LI><LI><B>規則 2:</B> 可能な場合には、読み取り専用パスを使用する。
<P>
<P>マウント・ポイントが読み取り専用ボリュームに常駐し、参照されるボリュームが複写されている場合には、キャッシュ・マネージャーはボリュームの読み取り専用コピーにアクセスしようとします。参照されたボリュームが複写されていない場合には、キャッシュ・マネージャーは読み取り / 書き込みコピーにアクセスします。このようにして、キャッシュ・マネージャーは、ファイル・スペースを通る<I>読み取り専用パス</I> を優先するように告げられ、使用可能な場合には、その読み取り専用ボリュームにアクセスします。
<P>
<P>キャッシュ・マネージャーは、常に、存在する場合には、<B>root.afs</B> ボリュームの読み取り専用コピーにアクセスするため、最初の場所にある読み取り専用パスで開始されます。ボリュームは、セルの AFS ファイル・スペース (規則では、<B>/afs</B> に指定される) のルートにマウントされます。すなわち、<B>root.afs</B> ボリュームが複写されている場合には、キャッシュ・マネージャーは、読み取り / 書き込みコピーではなく、読み取り専用コピーにアクセスしようとします。この規則により、各ボリュームが正常に複写されるまで、キャッシュ・マネージャーは読み取り専用パスで保持されます。
<B>root.afs</B> ボリュームおよび
<B>root.cell</B> ボリュームのどちらも複写され、
AFS ファイル・スペースでこれらのボリュームの下にマウントされた複写済みのボリュームに、キャッシュ・マネージャーがアクセスします。これらのボリュームは、従来通り、
<B>/afs</B> ディレクトリーおよび
<B>/afs/</B><VAR>cellname</VAR> ディレクトリーにそれぞれマウントされます。
</LI><LI><B>Rule 3:</B> 一度読み取り / 書き込みパスに入ったら、そのパスにとどまる。
<P>
<P>マウント・ポイントが読み取り / 書き込みボリュームに常駐し、ボリューム名に <B>.readonly</B> 拡張子または
<B>.backup</B> 拡張子がない場合には、キャッシュ・マネージャーは読み取り / 書き込みバージョンのボリュームにのみアクセスを試みます。読み取り / 書き込みバージョンがアクセス不能の場合には、読み取り専用バージョンがアクセス可能であっても、エラーのためにアクセスの試みは失敗します。この状態では、キャッシュ・マネージャーは、
<I>読み取り / 書き込みパス</I> にいることを知らされますが、
<B>.readonly</B> 拡張子を使ってボリュームを明示的に指定しなければ、読み取り専用パスに方向転換することはできません。
(次で説明するように、セルラー・マウント・ポイントは、この規則には重要な例外です。)
</LI></UL>
<P>マウント・ポイントには、キャッシュ・マネージャーが解釈する方法によって、
3 つのタイプがあり、それぞれの別々の目的に応じて割り当てられます。
<UL>
<LI>キャッシュ・マネージャーが<I>正規の</I> マウント・ポイントを渡る場合には、前に説明した 3 つすべてのマウント・ポイント走査規則に従います。標準のマウント・ポイントを作成するには、<B>fs mkmount</B> コマンドの必須の <B>-dir</B> および <B>-vol</B> 引き数だけを指定します。
<A NAME="IDX4898"></A>
<A NAME="IDX4899"></A>
<P>
<P>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">正規のマウント・ポイントは、いつでもキャッシュ・マネージャーに読み取り専用ボリュームにアクセスさせるわけではありません
(正規のマウント・ポイントは、明らかに "読み取り専用のマウント・ポイント" ではありません)。ボリュームを複写しない場合、3 番目の走査規則は、そのマウント・ポイントが唯一の使用可能なタイプである場合に、キャッシュ・マネージャーがまだ読み取り / 書き込みボリュームにアクセスすることを意味します。ただし、キャッシュ・マネージャーが、正規のマウント・ポイントで命名された複写済みのボリュームの読み取り専用バージョンにアクセスする場合には、パス名でマウント・ポイントの上にマウントされるすべてのボリュームも、複写しなければなりません。
</TD></TR></TABLE>
</LI><LI>キャッシュ・マネージャーは、<I>読み取り / 書き込み</I> マウント・ポイントを渡る場合には、そのマウント・ポイントで命名されたボリュームのバージョンだけにアクセスしようとします。ボリューム名が、
<B>.readonly</B> 拡張子または <B>.backup</B> 拡張子なしの基本 (読み取り / 書き込み) の形式である場合には、キャッシュ・マネージャーは、そのボリュームが複写されても、読み取り / 書き込みバージョンのボリュームにアクセスします。すなわち、キャッシュ・マネージャーは、読み取り / 書き込みマウント・ポイントを渡る場合には、
2 番目のマウント・ポイント走査規則を無視します。キャッシュ・マネージャーは、ファイル・スペースを通過する読み取り / 書き込みパスに切り替えます。
<A NAME="IDX4900"></A>
<A NAME="IDX4901"></A>
<P>
<P>
<P>読み取り / 書き込みマウント・ポイントを作成するには、
<B>-rw</B> フラグを <B>fs mkmount</B> コマンドに組み込みます。従来は、セルのファイル・スペースで読み取り / 書き込みマウント・ポイントを 1 つだけ作成し、このマウント・ポイントを使用して、セルの <B>root.cell</B> ボリュームを、
AFS ファイル・スペース・ルート
(規則では, <B>/afs/.</B><VAR>cellname</VAR>) のすぐ下にマウントします。説明については <I>AFS インストールの手引き</I> を、詳細については
<I>AFS 管理の手引き</I> のボリューム管理に関する章を参照してください。
<P>
<P>読み取り / 書き込みマウント・ポイントを読み取り専用またはバックアップ・ボリューム用に作成することはできますが、必要ありません。マウント・ポイント走査の最初の規則で、正規のマウント・ポイントのボリューム名に <B>.readonly</B> または
<B>.backup</B> 拡張子がある場合には、キャッシュ・マネージャーはこれらのボリュームにアクセスすることをすでに指定しています。
</LI><LI>キャッシュ・マネージャーは、
<I>セルラー</I> ・マウント・ポイントを渡る場合には、指定されたセル (通常は外部セル) で指示されたボリュームにアクセスします。
(マウント・ポイントがボリュームと一緒にセルに名前を付けない場合には、キャッシュ・マネージャーは、そのマウント・ポイントが常駐するセルのボリュームにアクセスします。)
キャッシュ・マネージャーは、正規のセルラー・マウント・ポイントを渡る場合には、
3 番目のマウント・ポイント走査規則を無視します。キャッシュ・マネージャーは、そのマウント・ポイントを格納するボリュームが読み取り / 書き込みであっても、読み取り専用バージョンのボリュームにアクセスします。外部セルのファイル・サーバー・マシンに過度のロードを負わせるのを回避するために、この方法で読み取り専用に切り替えることが計画されています。
<A NAME="IDX4902"></A>
<A NAME="IDX4903"></A>
<A NAME="IDX4904"></A>
<P>
<P>
<P>標準のセルラー・マウント・ポイントを作成するには、<B>fs mkmount</B> コマンドに <B>-cell</B> 引き数を指定します。従来は、セルのファイル・スペースの 2 番目のレベルでのみセルラー・マウント・ポイントを作成し、そのマウント・ポイントを使用して、外部セルの
<B>root.cell</B> ボリュームを、AFS ファイル・スペース・ルート
(規則では、<B>/afs/</B><VAR>foreign_cellname</VAR>) のすぐ下にマウントします。ユーザーがボリュームのルート・ディレクトリーの ACL で必要なアクセス権があること、それぞれのローカル・クライアント・マシンの <B>/usr/vice/etc/CellServDB</B> ファイルには外部セルの項目があることを想定し、マウント・ポイントを使用すると、ユーザーは外部セルのファイル・スペースにアクセスすることができます。
<B>fs lsmount</B> コマンドの出力に、先頭の番号記号と標準セルラー・マウント・ポイント名のボリューム名との間に、セル名およびコロン (<TT>:</TT>) が表示されます。
</LI></UL>
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>-dir
</B><DD>マウント・ポイントとして作成するディレクトリーを指定します。ディレクトリーはまだ存在していないものでなくてはなりません。相対するパス名は、現行作業ディレクトリーを基準にして解釈されます。
<P>
<P>ディレクトリーへの読み取り / 書き込みパスを指定し、読み取り専用ボリュームで新規マウント・ポイントを作成しようとして発生する障害を回避します。規則では、読み取り / 書き込みパスは、パス名の 2 番目のレベルのセル名の前にピリオドを入れて示します
(たとえば、<B>/afs/.example.com</B>)。ファイル・スペースを通る読み取り / 書き込みパスおよび読み取り専用パスの概念に関する詳細については、この参照ページの<B>説明</B>の節を参照してください。
<P><DT><B>-vol
</B><DD>ボリュームの名前またはボリューム ID を指定して、それをマウントします。適切ならば、名前に <TT>.readonly</TT> または <TT>.backup</TT> 拡張子を追加するか、該当するボリューム ID 番号を指定します。
<P><DT><B>-cell
</B><DD>ボリュームが常駐するセルを指定します (セルラー・マウント・ポイントを作成)。完全修飾ドメイン名、またはローカルの <B>/usr/vice/etc/CellServDB</B> ファイルにリストされている他のセルと区別できる短縮形を指定してください。
<P>
<P>この引き数が省略された場合、マウント・ポイントにセル・インディケーターは表示されません。キャッシュ・マネージャーはこれを解釈するとき、マウント・ポイントで指定されたボリュームが、マウント・ポイントを格納しているボリュームと同じセルに常駐しているものと想定します。
<P><DT><B>-rw
</B><DD>読み取り / 書き込みマウント・ポイントを作成します。標準のマウント・ポイントを作成するには、このフラグを省略します。
<P><DT><B>-fast
</B><DD>ボリューム・ロケーション (VL) サーバーが、ボリュームに VLDB 項目があるかどうかを検査し、なかった場合に警告メッセージを印刷することを防ぎます。ボリュームに VLDB 項目がなくても、このフラグが含まれているかどうかによって、ファイル・サーバーはマウント・ポイントを作成します。
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>例</STRONG>
<P>次のコマンドは標準のマウント・ポイントを作成し、<B>/afs/example.com/usr/smith</B> にボリューム <B>user.smith</B> をマウントします。
<PRE>   % <B>cd /afs/example.com/usr</B>

   %<B> fs mkmount -dir smith -vol user.smith</B>

</PRE>
<P>以下のコマンドは、
Example Corporation セルの <TT>root.cell</TT> ボリューム用の読み取り / 書き込みマウント・ポイントと正規のマウント・ポイントをそのセルのファイル・ツリーで作成します。
2 番目のコマンドは、読み取り / 書き込みマウント・ポイントの名前の始まりにピリオドを入れるという規則に従っています。
<PRE>   % <B>fs mkmount -dir /afs/example.com -vol root.cell</B>

   %<B> fs mkmount -dir /afs/.example.com -vol root.cell -rw</B>

</PRE>
<P>次のコマンドは、Example Organization セルの <TT>root.cell</TT> ボリュームを、Example Corporation セルのファイル・ツリーにマウントし、<B>/afs/example.org</B> という標準セルラー・マウント・ポイントを作成します。
Example Corporation のキャッシュ・マネージャーがこのマウント・ポイントに出会うと、読み取り専用パスで Example Organization セルに入り込みます。
<PRE>   % <B>fs mkmount -dir /afs/example.org -vol root.cell -c example.org</B>

</PRE>
<P><STRONG>必要となる特権</STRONG>
<P>発行者は、マウント・ポイントを格納するディレクトリーの ACL で
<B>i</B> (<B>挿入</B>) アクセス権と
<B>a</B> (<B>管理</B>) アクセス権が必要です。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf019.htm#HDRCLI_CSDB">CellServDB (クライアント・バージョン)</A>
<P><A HREF="auarf151.htm#HDRFS_LSMOUNT">fs lsmount</A>
<P><A HREF="auarf156.htm#HDRFS_RMMOUNT">fs rmmount</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf152.htm">前ページ</A> &#124; <A HREF="auarf154.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B>
<!-- Begin Footer Records  ========================================== -->
<P><HR><B>
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved
</B>
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
