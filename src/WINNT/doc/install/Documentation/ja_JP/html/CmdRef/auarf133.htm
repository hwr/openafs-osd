<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理解説書</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- C:\IDWB\TEMP\idwt1068\AUARF000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 21:46:04            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 21:46:02">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 21:46:02">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 21:46:02">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    -->
<BODY bgcolor="ffffff">
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理解説書</H1>
<P>
<H2><A NAME="HDRFS_CHECKSERVERS" HREF="auarf002.htm#ToC_147">fs checkservers</A></H2>
<A NAME="IDX4728"></A>
<A NAME="IDX4729"></A>
<A NAME="IDX4730"></A>
<A NAME="IDX4731"></A>
<A NAME="IDX4732"></A>
<A NAME="IDX4733"></A>
<A NAME="IDX4734"></A>
<A NAME="IDX4735"></A>
<P><STRONG>目的</STRONG>
<P>サーバー・マシンの状況を表示します。
<P><STRONG>構文</STRONG>
<PRE><B>fs checkservers</B> [<B>-cell</B> &lt;<VAR>cell to check</VAR>>]  [<B>-all</B>]  [<B>-fast</B>]
                [<B>-interval</B> &lt;<VAR>seconds between probes</VAR>>]  [<B>-help</B>]

<B>fs checks</B> [<B>-c</B> &lt;<VAR>cell to check</VAR>>]  [<B>-a</B>]  [<B>-f</B>]
          [<B>-i</B> &lt;<VAR>seconds between probes</VAR>>]  [<B>-h</B>]
</PRE>
<P><STRONG>構文</STRONG>
<P><B>fs checkservers</B> コマンドは、ローカル・クライアント・マシンから特定の AFS サーバー・マシンにアクセス可能かどうかを報告します。マシンは、2 つのクラスのうちのどちらかに属し、キャッシュ・マネージャーがそのリストをカーネル・メモリーで維持します。
<UL>
<LI>ローカルの <B>/usr/vice/etc/CellServDB ファイル</B> にリストされている各セル内のデータベース・サーバー・マシンおよび最後にリブートしてから <B>fs newcell</B> コマンドでメモリー・リストに追加されたすべてのマシン。
</LI><LI>キャッシュ・マネージャーが最後に接続し、すぐに再接続の必要があるすべてのファイル・サーバー・マシン。ほとんどの場合、マシンから取り出されたファイルまたはボリュームへのコールバックは、キャッシュ・マネージャーが保留にします。
</LI></UL>
<P>キャッシュ・マネージャーがデータベース・サーバー・マシン上の <B>vlserver</B> プロセスまたはファイル・サーバー・マシン上の <B>fileserver</B> プロセスに接続できない場合は、キャッシュ・マネージャーはマシンをアクセス不能とマークします。
(実際には、ファイル・サーバー・マシンがマルチホームの場合、キャッシュ・マネージャーはそのマシンのすべてのインターフェースへの接続を試み、<B>fileserver</B> がどこからも応答を得られない場合にのみ、このマシンを停止とマークします)。次に、キャッシュ・マネージャーは、定期的に (デフォルトで、3 分ごとに) マークされたマシンにプローブを送信し、マシンがまだアクセス不能かどうかを確認します。以前にアクセス不能だったマシンが応答した場合、キャッシュ・マネージャーはそのマシンをアクセス可能とマークし、定期的なプローブの送信をやめます。
<P><B>fs checkservers</B> コマンドは、キャッシュ・マネージャーのプローブをアクセス不能マシンの指定セットにし、そのマシン・リストを更新します。
<UL>
<LI>デフォルトでは、アクセス不能とマークされたマシンおよびローカル・セルに属するマシンのみ (<B>/usr/vice/etc/ThisCell</B> ファイルにリストされているセル)。
</LI><LI>引き数 <B>-cell</B> が組み込まれている場合には、アクセス不能のマークが付けられ、指定されたセルに属するマシンのみ
</LI><LI><B>-all</B> フラグがある場合、すべてのマシンはアクセス不能とマークされます。
</LI></UL>
<P><B>-fast</B> フラグがある場合、キャッシュ・マネージャーはどのマシンもプローブしません。その代わりに最後に行ったプローブの結果を報告します。
<P>アクセス不能マシンのリストを作成せずに、プローブの間隔を設定するには、<B>-interval</B> 引き数を使用してください。デフォ ルト以外の設定は、マシンをリブートするまで残っています。リブート後も残しておくには、適切な <B>fs checkservers</B> コマンドをマシンの AFS 初期化ファイルに入れてください。
<P><STRONG>注意</STRONG>
<P>多数のマシンがキャッシュ・マネージャーのプローブに応答しなかった場合、コマンドの完了に時間がかかることがあります。これは、キャッシュ・マネージャーが、低速のネットワーク通信を可能とするため、マシンに順次プローブを行い、マシンを応答不能とマークする前に標準タイムアウト期間を待機するからです。迅速にコマンド・シェルのプロンプトを戻すには、コマンドをバックグラウンドの状態にしてください。コマンドに割り込むには、&lt;<B>Ctrl-c</B>&gt; と入力するか、別の割り込み信号を入力してください。
<P>キャッシュ・マネージャーが、メモリー・リストにアクセス不能とマークされたサーバー・マシンにのみプローブを行うことに注意してください。出力でサーバー・マシンが欠けていることは、必ずしも、そのサーバー・マシンが機能していることを意味するわけではありません。それは、そのサーバー・マシンがメモリー・リストにまったく組み込まれていない可能性があるからです (たとえば、キャッシュ・マネージャーが最近交信していなかった場合)。同じ理由で、別のクライアント・マシンでの出力は異なる傾向があります。
<P>ほとんどの <B>fs</B> コマンドとは異なり、<B>fs checkservers</B> コマンドは AFSCELL 環境変数を参照しません。
<P><STRONG>オプション </STRONG>
<DL>
<P><DT><B>-cell
</B><DD>アクセス不能とマークされたサーバー・マシンのプローブを行うための各セルを指定します。完全修飾ドメイン名、またはローカルの <B>/usr/vice/etc/CellServDB</B> ファイルにリストされている他のセルと区別できる短縮形を指定してください。必要ならこの引き数を <B>-fast</B> フラグと一緒に使用してください。ただし、<B>-all</B> フラグと一緒に使用してはなりません。ローカル・セルのマシンのみに対してプローブを行う場合は、この 2 つの引き数および <B>-all</B> フラグを省略してください。
<P><DT><B>-all
</B><DD>キャッシュ・マネージャーのメモリー・リストでアクセス不能にマークされているすべてのマシンにプローブを行います。希望する場合は、この引き数を <B>-fast</B> フラグを結合してください。ただし、<B>-cell</B> 引き数と結合しないでください。ローカル・セルのマシンのみにプローブを行う場合は、この 2 つのフラグおよび <B>-cell</B> 引き数を省略してください。
<P><DT><B>-fast
</B><DD>新しいプローブを送信する代わりに、キャッシュ・マネージャーのアクセス不能マシンの現行リストを表示します。出力は、現在設定されているプローブの間隔と同じくらい以前のものでもかまいません (デフォルトで、3
分。最大で 10 分)。
<P><DT><B>-interval
</B><DD>キャッシュ・マネージャーのメモリー・リストでアクセス不能にマークされているマシンに送信するプローブ間の秒数を設定または報告します。
<UL>
<LI>間隔を設定するには、<B>1</B> から <B>600</B> (10 分) の範囲で値を指定してください。デフォルトは、<B>180</B> (3 分) です。コマンドの発行者は、ローカル・スーパーユーザー <B>root</B> としてログインする必要があります。更新された設定は、再度このコマンドで変更するか、マシンをリブートして設定をデフォルト値に戻すまで持続します。
</LI><LI>値を <B>0</B> (ゼロ) に指定すると、現在の間隔設定が表示されます。特権は必要ありません。この引き数を他のものと一緒に使用しないでください。
</LI></UL>
<P><DT><B>-help
</B><DD>このコマンドのオンライン・ヘルプを出力します。これ以外の有効なオプションはすべて無視されます。
</DL>
<P><STRONG>出力</STRONG>
<P>アクセス不能とマークされたマシンがない場合、またはそのすべてが現在キャッシュ・マネージャーのプローブに応答している場合の出力は次のとおりです。
<PRE>   All servers are running.

</PRE>
<P>このメッセージは、それぞれのセルに関係のあるすべてのサーバー・マシンが実行されていることを意味するものでないことに注意してください。出力は、キャッシュ・マネージャーがプローブを行うマシンの状況のみを示しています。
<P>マシンがタイムアウト期間内にプローブに応答しなかった場合、出力は次の文字列で開始されます。
<PRE>   These servers unavailable due to network or server problems:

</PRE>
<P>その後、各マシンのホスト名をそれに対応する行にリストします。キャッシュ・マネージャーは、マシン・レコードを IP アドレスで格納しています。したがって、各ホスト名の書式 (英大文字か英小文字、または小数点付き 10 進数形式の IP アドレス) は、ローカル・セルのネーム・サービスが、コマンド発行時にそれをどのように変換するかによって違います。サーバー・マシンがマルチ・ホームである場合は、出力は、サーバー・マシンのインターフェースの 1 つだけをリストします
(通常は、現在最も優先されるインターフェース)。
<P><B>-interval</B> 引き数に <B>1</B> から <B>600</B> の間の値を与えると、出力されません。値 が <B>0</B> の場合、出力は次のようなプローブ間隔を報告します。
<PRE>   The current down server probe interval is <VAR>interval</VAR> secs

</PRE>
<P><STRONG>例</STRONG>
<P>次のコマンドは、再度プローブを行う代わりに、キャッシュ・マネージャーにある応答不能マシンの現行リストを表示します。出力は、アクセス不能とマークされたマシンがあるかどうか、すべてのマシンが直前のプローブに応答しているかどうかを示します。
<PRE>   % <B>fs checkservers -fast</B>
   All servers are running.

</PRE>
<P>キャッシュ・マネージャーのメモリー・リストにある <B>example.org</B> セルに属するマシンのプローブを行います。
<PRE>   % <B>fs checkservers -cell example.org</B>
   All servers are running.

</PRE>
<P>次の例では、キャッシュ・マネージャーのメモリー・リストにあるすべてのサーバー・マシンのプローブを行います。このプローブに応答しなかったマシン 2 台が報告されます。
<PRE>   % <B>fs checkservers -all</B>
   These servers unavailable due to network or server problems:
   fs1.example.com SV3.STATE.EDU.

</PRE>
<P><STRONG>必要となる特権</STRONG>
<P>プローブ間隔を設定するには、発行者がローカル・スーパーユーザー <B>root</B> としてログインしなくてはなりません。そうでない場合、特権は必要ありません。
<P><STRONG>関連情報 </STRONG>
<P><A HREF="auarf019.htm#HDRCLI_CSDB">CellServDB (クライアント・バージョン)</A>
<P><A HREF="auarf032.htm#HDRCLI_THISCELL">ThisCell (クライアント・バージョン)</A>
<P><A HREF="auarf154.htm#HDRFS_NEWCELL">fs newcell</A>
<P>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auarf132.htm">前ページ</A> &#124; <A HREF="auarf134.htm">次ページ</A> &#124; <A HREF="auarf002.htm#ToC">目次</A> &#124; <A HREF="auarf284.htm#HDRINDEX">索引</A> &#93;</B>
<!-- Begin Footer Records  ========================================== -->
<P><HR><B>
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved
</B>
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
