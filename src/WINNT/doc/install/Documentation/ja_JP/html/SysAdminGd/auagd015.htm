<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 3//EN">
<HTML><HEAD>
<TITLE>管理の手引き</TITLE>
<!-- Begin Header Records  ========================================== -->
<!-- E:\IDWB\TEMP\idwt2118\AUAGD000.SCR converted by idb2h R4.2 (359) -->
<!-- ID Workbench Version (OS2) on 24 Dec 1999 at 12:07:32            -->
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Shift_JIS">
<META HTTP-EQUIV="updated" CONTENT="Fri, 24 Dec 1999 12:07:30">
<META HTTP-EQUIV="review" CONTENT="Sun, 24 Dec 2000 12:07:30">
<META HTTP-EQUIV="expires" CONTENT="Mon, 24 Dec 2001 12:07:30">
</HEAD><BODY>
<!-- (C) IBM Corporation 2000. All Rights Reserved    -->
<BODY bgcolor="ffffff">
<!-- End Header Records  ============================================ -->
<A NAME="Top_Of_Page"></A>
<H1>管理の手引き</H1>
<P>
<A NAME="IDX7303"></A>
<A NAME="IDX7304"></A>
<HR><H1><A NAME="HDRWQ513" HREF="auagd002.htm#ToC_431">クライアント・マシンとキャッシュ・マネージャーの管理</A></H1>
<P>この章では、ユーザーがそこから AFS ファイル・スペースにアクセスし、AFS サーバー・プロセスと通信することができる任意のマシンである AFS クライアント・マシンについて説明します。(クライアント・マシンを適切に構成すると、クライアント・マシンは同時に AFS サーバー・マシンとして機能することができます)。AFS クライアント・マシンの特徴は次のとおりです。
<UL>
<LI>カーネルが、AFS ファイルおよびディレクトリーへのアクセスを可能にする、一般にキャッシュ・マネージャーと呼ばれる変更セットを含む。キャッシュ・マネージャーの多くの機能をユーザーのニーズに沿って構成することができます。
<A HREF="#HDRWQ537">キャッシュ・マネージャーの概要</A>を参照してください。
</LI><LI>ローカル・ディスク上の <B>/usr/vice/etc</B> ディレクトリーが、いくつかの構成ファイルを保管する。
<A HREF="#HDRWQ539">/usr/vice/etc ディレクトリー内の構成ファイル</A>を参照してください。
</LI><LI>AFS ファイル・サーバー・マシンからフェッチしたデータの一時的なコピーを保管するキャッシュが存在する。<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A> および <A HREF="#HDRWQ549">afsd プログラムを使用してその他のパラメーターを設定する</A>を参照してください。
</LI></UL>
<P>マシンへクライアント機能を導入する方法について確認するためには、<I>AFS インストールの手引き</I> を参照してください。
<HR><H2><A NAME="HDRWQ514" HREF="auagd002.htm#ToC_432">説明の要約</A></H2>
<P>この章では、以下のタスクを、その隣に示されたコマンドを使用して実行するための方法について説明します。
<BR>
<TABLE WIDTH="100%">
<TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">リブート時のキャッシュ・サイズの設定を表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>cat /usr/vice/etc/cacheinfo</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">現行のキャッシュ・サイズおよび使用を表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs getcacheparms</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">リブートせずにディスク・キャッシュ・サイズを変更する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs setcachesize</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">キャッシュ・マネージャーを初期化する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>afsd</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%"><B>CellServDB</B> ファイルの内容を表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>cat /usr/vice/etc/CellServDB</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">カーネル・メモリー内のデータベース・サーバー・マシンのリストを表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs listcells</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">カーネル・メモリー内のデータベース・サーバー・マシンのリストを変更する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs newcell</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">セルの setuid の状況を検査する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs getcellstatus</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">セルの setuid の状況を設定する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs setcell</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">サーバーのプローブ間隔を設定する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs checkservers -interval</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">マシンのセル・メンバーシップを表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>cat /usr/vice/etc/ThisCell</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">マシンのセル・メンバーシップを変更する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%">Edit <B>/usr/vice/etc/ThisCell</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">キャッシュされたファイルまたはディレクトリーをフラッシュする
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs flush</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">ボリュームからキャッシュされたすべての内容をフラッシュする
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs flushvolume</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">ボリューム対マウント・ポイント・マッピングを更新する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs checkvolumes</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">キャッシュ・マネージャーのサーバー・プリファレンス・ランクを表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs getserverprefs</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">キャッシュ・マネージャーのサーバー・プリファレンス・ランクを設定する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs setserverprefs</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">登録するクライアント・マシンのアドレスを表示する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs getclientaddrs</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">登録するクライアント・マシンのアドレスを設定する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs setclientaddrs</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">警告および状況メッセージの表示を制御する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs messages</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">マシンのシステム・タイプを表示および変更する
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs sysname</B>
</TD></TR><TR>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH="67%">非同期書き込みを使用可能にする
</TD><TD ALIGN="LEFT" VALIGN="TOP" WIDTH="33%"><B>fs storebehind</B>
</TD></TR></TABLE>
<HR><H2><A NAME="HDRWQ537" HREF="auagd002.htm#ToC_433">キャッシュ・マネージャーの概要</A></H2>
<A NAME="IDX7305"></A>
<A NAME="IDX7306"></A>
<A NAME="IDX7307"></A>
<P>AFS クライアント・マシンのカーネルには、一般に<I>キャッシュ・マネージャー</I> と呼ばれる変更セットが含まれます。この変更セットは AFS ファイルおよびディレクトリーへのアクセスおよび AFS サーバー・プロセスとの通信を可能にします。一般にキャッシュ・マネージャーはあたかもプロセスまたはプログラムであるかのように言及されますが、通常の使用ではプロセスまたはプログラムの 1 つとして機能するように思われます。ただし、キャッシュ・マネージャーを構成する際には、このような使用は厳密には正しくないことを念頭に入れてください。
<P>キャッシュ・マネージャーの主要な機能は、マシン上で実行されているアプリケーション・プログラムの代わりにファイルをフェッチすることです。アプリケーションがあるファイルを要求すると、キャッシュ・マネージャーは、ボリューム・ロケーション (VL) ・サーバーにアクセスして、該当するファイルを含むボリュームが存在するファイル・サーバー・マシンのリストを入手します。その後キャッシュ・マネージャーは、アプリケーション・プログラムのシステム呼び出し要求を、適切なマシン上で実行されているファイル・サーバーへのリモート・プロシージャー呼び出し (RPC) に変換します。ファイル・サーバーがアプリケーションが要求したファイルを送達すると、キャッシュ・マネージャーはそのファイルをアプリケーション・プログラムに引き渡す前にローカル・<I>キャッシュ</I> に保管します。
<P>ファイル・サーバーは、
<I>コールバック</I> と呼ばれるデータ構造をファイルと共に送達します。(厳密にいえば、ファイル・サーバーは、読み取り / 書き込みボリュームからフェッチされたファイルに対してはファイルごとにコールバックを送達し、読み取り専用ボリュームからフェッチされたすべてのデータに対しては単一のコールバックを送達します。)有効なコールバックは、キャッシュ・マネージャーによってキャッシュされたファイルのコピーが、ファイル・サーバーが保持する中央コピーと一致することを示します。別の AFS クライアント・マシンのアプリケーションが中央コピーを変更すると、ファイル・サーバーはコールバックを切断します。すると、キャッシュ・マネージャーは、そのマシン上にあるアプリケーション・プログラムが該当するファイルのデータを次に要求するときに新しいバージョンを検索する必要があります。ただし、コールバックが切断されている間、キャッシュ・マネージャーは、ファイルのキャッシュ・バージョンをそのマシン上にあるアプリケーションに提供し続けることができるので、不必要なネットワーク通信量が減少します。
<P>以下で指示するこの章の節において、以下のキャッシュ・マネージャーの機能を構成およびカスタマイズする方法を説明します。最初 (ディスクまたはメモリー・キャッシュの選択) 以外のすべての機能は任意選択です。最初の機能に関しては、AFS によって適切なデフォルトが設定されます。
<UL>
<LI><I>ディスクまたはメモリー・キャッシュ</I>。
AFS キャッシュ・マネージャーは、ローカル・ディスク上のスペースの代わりにマシン・メモリーをキャッシュに使用することができます。最も基本的な構成上の決定は、どちらを使用するかを決めることです。
<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>を参照してください。
</LI><LI><I>キャッシュ・サイズ</I>。キャッシュ・サイズは、クライアント・マシンのパフォーマンスに最も直接的に影響します。キャッシュ・サイズは、キャッシュ・マネージャーがネットワーク内のファイル・サーバーと通信する回数、または新規に要求されたファイルのスペースを確保するためにキャッシュされたデータを廃棄する回数を決定します。これらは共にキャッシュ・マネージャーがユーザーにファイルを送達する速さに影響します。
<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>を参照してください。
</LI><LI><I>キャッシュ・ロケーション</I>。ディスク・キャッシュに対して、従来のキャッシュ・ディレクトリー・ロケーション (<B>/usr/vice/cache</B>) を変更して、マシン上の他のディスクで使用可能なより大きなスペースを利用することができます。より大きなキャッシュは、より迅速なファイルの送達を可能にします。
<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>を参照してください。
</LI><LI><I>チャンクのサイズおよび数</I>。キャッシュ・マネージャーを初期化する <B>afsd</B> プログラムを使用して、キャッシュをどのサイズおよび数のチャンクに分割するか、さらに関連するパラメーターを制御します。適切なデフォルトが用意されているため、これらのパラメーターの設定は任意選択ですが、これらのパラメーターを使用するとより正確に制御することができます。AFS の配布には、キャッシュ・マネージャーのパラメーターをさまざまな構成および使用パターンに適した値に設定する構成スクリプトが含まれます。
<A HREF="#HDRWQ549">afsd プログラムを使用してその他のパラメーターを設定する</A>を参照してください。
</LI><LI><I>データベース・サーバー・マシンの情報</I>。セル内のデータベース・サーバー・マシンのリストをローカル・ディスク上の <B>/usr/vice/etc/CellServDB</B> ファイル内に作成することによって、クライアント・マシンのユーザーがセルの AFS ファイル・スペースおよびその他のサービスにアクセスできるようにします。<A HREF="#HDRWQ553">データベース・サーバー・マシンの情報を保持する</A>を参照してください。
</LI><LI><I>setuid 特権</I>。システム管理者は、キャッシュ・マネージャーが setuid 許可を使用してセル内のプログラムを実行するかどうかを制御することができます。
<A HREF="#HDRWQ556">クライアントが Setuid プログラムを実行できるかどうかを決定する</A>を参照してください。
</LI><LI><I>セル・メンバーシップ</I>。各クライアントは 1 つのセルに属します。どのセルに属するかはローカルな<B>/usr/vice/etc/ThisCell</B> ファイルで定義されています。セル・メンバーシップは、マシンのユーザーを識別し、
AFS コマンドを実行するデフォルトのセルを決定します。<A HREF="#HDRWQ558">クライアント・マシンのセル・メンバーシップを設定する</A>を参照してください。
</LI><LI><I>キャッシュ・ファイルのバージョン</I>。
AFS のコールバックのシステムは、通常はキャッシュ・マネージャーがファイルおよびディレクトリーの最新バージョンを保持することを保証します。ただし、キャッシュに含まれるものが古いバージョンである疑いがある場合は、ファイル・サーバーからファイルの最新バージョンをキャッシュ・マネージャーに強制的にフェッチさせることができます。
<A HREF="#HDRWQ559">キャッシュ・データの更新を強制する</A>を参照してください。
</LI><LI><I>ファイル・サーバーおよびボリューム・ロケーション・サーバーのプリファレンス</I>。キャッシュ・マネージャーは、ファイル・サーバー・マシンおよびボリューム・サーバー (VL)・マシンのインターフェースの数値によるプリファレンス・ランクを設定します。このランクは、ボリュームまたはボリューム・ロケーション・データベース (VLDB) からデータをフェッチするときに、キャッシュ・マネージャーが最初に使用するインターフェースを決定します。キャッシュ・マネージャーは、デフォルトのランクを初期化の際に設定します。ランクは、キャッシュ・マネージャーと各インターフェースとのネットワーク接近性に基づいて設定されますが、必要であればプリファレンスのランクを変更することができます。
<A HREF="#HDRWQ561">サーバーのプリファレンス・ランクの保守</A>を参照してください。
</LI><LI><I>ファイル・サーバーに登録済みのインターフェース</I>。キャッシュ・マネージャーがマルチホーム (複数のインターフェース・アドレスを持つ) である場合、ファイル・サーバーがクライアント・マシンへの RPC を開始するとき、どのキャッシュ・マネージャーを使用してファイル・サーバーに登録するかを制御することができます。<A HREF="#HDRWQ562">マルチホーム・クライアント・マシンの管理</A>を参照してください。
</LI><LI><I>情報メッセージの表示</I>。デフォルトでは、キャッシュ・マネージャーは、クライアント・マシンのコンソールおよびコマンド・シェルに基本エラーおよび情報メッセージを表示します。メッセージを表示しないこともできます。
<A HREF="#HDRWQ563">警告および状況メッセージの表示を制御する</A>を参照してください。
</LI><LI><I>システム・タイプ</I>。キャッシュ・マネージャーは、カーネル・メモリーにローカル・マシンの AFS システム・タイプをレコードし、パス名に対して <VAR>@sys</VAR> 変数の値を置換します。<A HREF="#HDRWQ564">システム・タイプ名の表示および設定</A>を参照してください。
</LI><LI><I>遅延書き込み</I>。デフォルトで、キャッシュ・マネージャーは、アプリケーション・プログラムがファイルをクローズするときに、即時にかつ同期的にファイル・サーバーにすべてのデータを書き込みます。非同期書き込みは、キャッシュ・マネージャーが扱う個々のファイルまたはすべてのファイルのいずれかに対して使用可能にすることができます。また、キャッシュ・マネージャーが終了するアプリケーションに再び制御を戻すときに、書き込むデータをどのくらい残すかを設定することができます。
<A HREF="#HDRWQ565">非同期書き込みを使用可能にする</A>を参照してください。
</LI></UL>
<P>構成の変更はすべてクライアント・マシン上で行う必要があります
(コンソール上でまたは <B>telnet</B> 接続などの直接接続を介して)。キャッシュ・マネージャーをリモートで構成することはできません。システム管理者がいくつかのコマンドを発行するためには、ローカル・スーパーユーザー <B>root</B> としてログインする必要がありますが、その他のユーザーは何も特権を必要としません。この章で説明するすべてのファイルは、各 AFS クライアント・マシンのローカル・ディスク上に実際に常駐する必要があります
(たとえば、ファイルが AFS 内のファイルへのシンボリック・リンクであってはなりません)。
<P>AFS の<B>パッケージ</B>・プログラムには、通常クライアント・マシンの AFS 初期設定ファイルに設定する機能が含まれ、クライアント・マシンを構成する際のその他の設定作業を単純化します。<A HREF="auagd016.htm#HDRWQ566">パッケージ・プログラムを使用したクライアント・マシンの構成</A>を参照してください。
<HR><H2><A NAME="HDRWQ538" HREF="auagd002.htm#ToC_434">ローカル・ディスク上の構成ファイルおよびキャッシュ関連ファイル</A></H2>
<A NAME="IDX7308"></A>
<A NAME="IDX7309"></A>
<A NAME="IDX7310"></A>
<A NAME="IDX7311"></A>
<A NAME="IDX7312"></A>
<P>この機能グループでは、すべてのクライアント・マシンのローカルな <B>/usr/vice/etc</B>
ディレクトリー上に常駐する必要があるクライアント構成ファイルについて簡単に説明します。マシンがディスク・キャッシュを使用する場合は、キャッシュ・ファイル専用のパーティションが必要です。キャッシュ・ファイルは、慣例では、
<B>/usr/vice/cache</B> ディレクトリーにマウントされます。
<P><B>Windows ユーザーへの注:</B> 本書で説明されているファイルの一部は、Windows オペレーティング・システムを実行しているマシンには存在していないかもしれません。また、Windows は、パス名の要素を分離するのに円記号 ( <B>\</B> ) を使用し、スラッシュ ( <B>/</B> ) は使用しません。
<P><H3><A NAME="HDRWQ539" HREF="auagd002.htm#ToC_435">/usr/vice/etc ディレクトリー内の構成ファイル</A></H3>
<P>キャッシュ・マネージャーが正常に機能するためには、クライアント・マシンのローカル・ディスク上の <B>/usr/vice/etc</B> ディレクトリーに、特定のいくつかの構成ファイルが含まれていなければなりません。これらの構成ファイルは、キャッシュ・マネージャー構成の最も基本的な機能を制御します。
<P>セル内のクライアント・マシンが一定の規則に従って実行されることが重要である場合は、これらの構成ファイルを中央ソースから更新することが最も効果的です。以下の説明には、最適なファイルの保守方法を説明する節の参照箇所が記載されています。
<DL>
<A NAME="IDX7313"></A>
<A NAME="IDX7314"></A>
<A NAME="IDX7315"></A>
<A NAME="IDX7316"></A>
<A NAME="IDX7317"></A>
<P><DT><B>afsd
</B><DD>キャッシュ・マネージャーを初期化するプログラムのバイナリー・ファイルです。このプログラムは、マシンが AFS クライアント・マシンとして機能するためにリブートされるごとに実行される必要があります。このプログラムはさらに、キャッシュ・マネージャーの機能を向上させるいくつかのデーモン、たとえば、コールバックを扱うプロセスなどを初期化します。
<A NAME="IDX7318"></A>
<A NAME="IDX7319"></A>
<P><DT><B>cacheinfo
</B><DD>キャッシュの最も基本的な構成パラメーターである、キャッシュ・マネージャーが AFS ファイル・スペースをマウントするローカル・ディレクトリー、キャッシュとして使用するローカル・ディスク・ディレクトリー、およびキャッシュに割り当てる K バイトの数を設定する 1 行で構成されるファイルです。
<P>
<P><I>AFS インストールの手引き</I> には、クライアント・マシンをインストールする際に行うこのファイルの作成方法が記載されています。マシンがメモリー・キャッシュを使用している場合は、キャッシュ・サイズを変更するためにファイルを編集して、マシンをリブートします。ディスク・キャッシュを使用するマシンでは、
<B>fs setcachesize</B> コマンドを発行することによってリブートせずにキャッシュ・サイズを変更することができます。説明については、<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>を参照してください。
<A NAME="IDX7320"></A>
<A NAME="IDX7321"></A>
<P><DT><B>CellServDB
</B><DD>この ASCII ファイルは、このマシンからアクセスできるようにするローカル・セル内および任意の外部セル内のデータベース・サーバー・マシンを指定します。
(データベース・サーバー・マシンは、認証、バックアップ、保護、および VL サーバーのプロセスを実行するセル内のマシンです。
<A HREF="auagd008.htm#HDRWQ127">データベース・サーバー・マシン</A>を参照してください。)
<P>
<P>キャッシュ・マネージャーは、セル内のデータベース・サーバー・マシンにアクセスして、そのファイル・スペースからファイルをフェッチできる必要があります。
<B>CellServDB</B> ファイル内の誤った情報または情報の欠落は、アクセスを遅らせたり、完全に遮断したりします。セルのデータベース・サーバー・マシンが変更された場合は、このファイルを更新してください。
<P>
<P><B>afsd</B> プログラムがキャッシュ・マネージャーを初期化すると、キャッシュ・マネージャーはファイルの内容をカーネル・メモリーにロードします。キャッシュ・マネージャーは、リブート時以外はそのファイルを読み取らないため、ファイルの変更をカーネル・メモリーに入れるためにはマシンをリブートする必要があります。ファイルを変更する代わりに、
<B>fs newcell</B> コマンドを発行して、変更を直接カーネル・メモリーに挿入することができます。中央のソースからファイルをアップグレードする方法も有用です。説明については、<A HREF="#HDRWQ553">データベース・サーバー・マシンの情報を保持する</A> を参照してください。
<P>
<P>(クライアント・マシン上の <B>CellServDB</B> ファイルは、サーバー・マシン上の <B>/usr/afs/etc</B> ディレクトリー内で保持されているファイルと同一のものではありません。サーバー・マシン上の <B>/usr/afs/etc</B> ディレクトリー内のファイルは、ローカル・セルのデータベース・サーバー・マシンのみをリストします。サーバーの <B>CellServDB</B> ファイルの保持に関する説明は、
<A HREF="auagd008.htm#HDRWQ153">サーバー CellServDB ファイルの保守</A>を参照してください)。
<A NAME="IDX7322"></A>
<A NAME="IDX7323"></A>
<P><DT><B>NetInfo
</B><DD>このオプションの ASCII ファイルは、クライアント・マシン上にある 1 つまたは複数のネットワーク・インターフェース・アドレスをリスト表示します。このファイルがキャッシュ・マネージャーの初期設定時に存在する場合は、キャッシュ・マネージャーは、ファイル・サーバーに登録するインターフェースのリストの基本としてこれを使用します。
<A HREF="#HDRWQ562">マルチホーム・クライアント・マシンの管理</A>を参照してください。
<A NAME="IDX7324"></A>
<A NAME="IDX7325"></A>
<P><DT><B>NetRestrict
</B><DD>このオプションの ASCII ファイルは、1 つまたは複数のネットワーク・インターフェース・アドレスをリスト表示します。このファイルがキャッシュ・マネージャーの初期設定時に存在する場合は、キャッシュ・マネージャーは、ファイル・サーバーに登録するインターフェースのリストから指定アドレスを削除します。
<A HREF="#HDRWQ562">マルチホーム・クライアント・マシンの管理</A>を参照してください。
<A NAME="IDX7326"></A>
<A NAME="IDX7327"></A>
<P><DT><B>ThisCell
</B><DD>この ASCII ファイルは、マシンが所属するセルの完全なドメイン形式の名前を指定する単一の行を含みます。<TT>example.com</TT> および <TT>example.org</TT> がその一例です。この値は、マシンのユーザーが認証済みユーザーとなり、コマンド・インタープリター (たとえば、
<B>bos</B>) がサーバー・プロセスにアクセスする、デフォルトのセルを定義します。
<P>
<P><I>AFS インストールの手引き</I> には、AFS クライアントの機能をインストールする際に行うこのファイルの作成方法が記載されています。クライアント・マシンのセル・メンバーシップの変更について確認するには、
<A HREF="#HDRWQ558">クライアント・マシンのセル・メンバーシップを設定する</A>を参照してください。
</DL>
<P>これらファイルの他にも、<B>/usr/vice/etc</B> ディレクトリーには、以下のタイプのファイルおよびサブディレクトリーが含まれる場合があります。
<UL>
<A NAME="IDX7328"></A>
<A NAME="IDX7329"></A>
<A NAME="IDX7330"></A>
<A NAME="IDX7331"></A>
<LI>AFS 初期化スクリプト (多くのシステム・タイプで <B>afs.rc</B> と呼ばれる)。
<I>AFS インストールの手引き</I> で指定されている通常の構成では、これはオペレーティング・システムが使用する他の初期設定ファイルと同じディレクトリーに保管される実際のスクリプトへの記号リンクです。
<A NAME="IDX7332"></A>
<A NAME="IDX7333"></A>
</LI><LI>動的カーネル・ロード・プログラムが使用する AFS カーネル・ライブラリー・ファイルを含むサブディレクトリー。
<A NAME="IDX7334"></A>
<A NAME="IDX7335"></A>
</LI><LI><B>C</B> 名のサブディレクトリー
(<B>afszcm.cat</B> 名のキャッシュ・マネージャー・カタログ・ファイルを含む)。fstrace プログラムは、カタログ・ファイルを使用して演算子を文字列に変換し、これによりトレース・ログのメッセージを読みやすくします。
<A HREF="auagd013.htm#HDRWQ465">fstrace コマンド・スイートについて</A>を参照してください
</LI></UL>
<P><H3><A NAME="HDRWQ540" HREF="auagd002.htm#ToC_436">キャッシュ関連ファイル</A></H3>
<A NAME="IDX7336"></A>
<A NAME="IDX7337"></A>
<A NAME="IDX7338"></A>
<A NAME="IDX7339"></A>
<A NAME="IDX7340"></A>
<P>ディスク・キャッシュを使用するクライアント・マシンは、このキャッシュ専用のローカル・ディスク・ディレクトリーを保持する必要があります。標準的なマウント・ポイントは <B>/usr/vice/cache</B> ですが、利用できるより大きいスペースを持つ別のパーティションを使用することができます。
<P>キャッシュ・ディレクトリー内のどのファイルも削除または直接変更しないでください。こららのファイルを変更または削除すると、カーネルの緊急事態が発生する場合があり、緊急事態からの唯一の回復方法はマシンをリブートすることだけです。デフォルトにより、ローカルのスーパーユーザー <B>root</B> だけがこれらのファイルを所有するため、これらのファイルを直接読み取ることができます。
<P>メモリー・キャッシュを使用するクライアント・マシンは、これらのファイルに保管されるすべての情報を、代わりにマシン・メモリーで保持します。
<DL>
<A NAME="IDX7341"></A>
<A NAME="IDX7342"></A>
<P><DT><B>CacheItems
</B><DD>キャッシュ・マネージャーが、ファイル ID 番号 (fID) およびデータ・バージョン番号を含むキャッシュ・チャンクの内容を記録する、バイナリー形式のファイルです (以下で説明するディレクトリーの <B>V</B> ファイル)。
<A NAME="IDX7343"></A>
<A NAME="IDX7344"></A>
<P><DT><B>VolumeItems
</B><DD>マウント・ポイントとキャッシュ・マネージャーがデータをフェッチするボリューム間のマッピングをキャッシュ・マネージャーが記録するバイナリー形式のファイルです。キャッシュ・マネージャーは、特に <B>pwd</B> コマンドに応答する際にこの情報を使用します。
<A NAME="IDX7345"></A>
<A NAME="IDX7346"></A>
<A NAME="IDX7347"></A>
<P><DT><B>V<VAR>n</VAR>
</B><DD>AFS ファイルからフェッチされたデータを入れるために最大サイズ
(デフォルトでは 64 KB) まで大きくなるキャッシュ・チャンク・ファイルです。キャッシュ内の <B>V</B><VAR>n</VAR> ファイルの数は、その他の要因の中でのキャッシュ・サイズによって異なります。<VAR>n</VAR> は、各ファイルに割り当てられるインデックスです。このインデックスは順次的に番号が付けられますが、キャッシュ・マネージャーは必ずしもこれらのインデックスを順次にまたは連続して使用しません。AFS ファイルが <B>V</B><VAR>n</VAR> ファイルの最大サイズより大きい場合は、キャッシュ・マネージャーはこのファイルを分割して複数の <B>V</B><VAR>n</VAR> ファイルに入れます。
</DL>
<HR><H2><A NAME="HDRWQ541" HREF="auagd002.htm#ToC_437">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A></H2>
<P>この節では、メモリーまたはディスク・キャッシュの構成方法、どちらのタイプのキャッシュであるかを表示してサイズを設定する方法、およびディスク・キャッシュのためのキャッシュ・ディレクトリーのロケーションを設定する方法について説明します。
<A NAME="IDX7348"></A>
<A NAME="IDX7349"></A>
<P>キャッシュ・マネージャーは、デフォルトによりディスク・キャッシュを使用します。ディスク・キャッシュは、優先されるキャッシュ・タイプです。メモリー・キャッシュを構成するには、通常マシンの AFS 初期設定ファイルの一部として起動される <B>afsd</B> コマンドに <B>-memcache</B> フラグを組み込みます。メモリー・キャッシュを使用して構成した場合、キャッシュ・マネージャーはマシンにディスクが備わっている場合でもディスクへのキャッシュを行いません。
<P><H3><A NAME="Header_438" HREF="auagd002.htm#ToC_438">キャッシュ・サイズを選択する</A></H3>
<A NAME="IDX7350"></A>
<P>キャッシュ・サイズは、他のどのキャッシュ・パラメーターよりもクライアント・マシンのパフォーマンスに直接的に影響します。キャッシュが大きい程、より速くキャッシュ・マネージャーがファイルをユーザーに送達する可能性が高くなります。小さなキャッシュは、キャッシュ・マネージャーがキャッシュされたデータを廃棄して、新規に要求されたデータのためのスペースを確保しなければならない回数を増やすため、パフォーマンスを低下させます。アプリケーションが廃棄されたデータを要求する場合、キャッシュ・マネージャーはそのデータをファイル・サーバーに要求しますが、ネットワーク内からデータをフェッチする方が、データをローカル・ディスクからフェッチするよりもほとんどの場合、より多くの時間を要します。キャッシュ・マネージャーは、ローカルで変更され、まだファイル・サーバーに保管されていないファイルのデータは決して廃棄しません。キャッシュがかなり小さいと、キャッシュ・マネージャーは、廃棄するファイルを見つけるのが難しいでしょう。キャッシュ・データを廃棄するときにキャッシュ・マネージャーが使用するアルゴリズムについての詳細は、
<A HREF="#HDRWQ548">キャッシュ・マネージャーが廃棄するデータを選択する方法</A>を参照してください。
<P>キャッシュに専用に割り当てるディスクまたはメモリーの大きさは、いくつかの要因に依存します。メモリー内またはディスク・キャッシュ・ディレクトリー上のパーティションで使用可能なスペースの大きさには、絶対的な制限があります。さらに、キャッシュ・ディレクトリーのパーティションで使用可能なスペースの 95% 以上をディスク・キャッシュに割り当てることはできません。この制限を超えた場合は、<B>afsd</B> プログラムはキャッシュ・マネージャーを開始せずに終了し、標準出力ストリームに適切なメッセージを表示します。メモリー・キャッシュの場合は、他のプロセスおよびアプリケーションの実行に必要なメモリーを残す必要があります。実際に割り振り可能なメモリーよりも多くのメモリーを割り当てようとすると、<B>afsd</B> プログラムはキャッシュ・マネージャーの初期設定を行わずに終了し、以下のメッセージを標準出力ストリームに表示します。
<PRE>   afsd: memCache allocation failure at <VAR>number</VAR> KB
</PRE>
<P>ここで、<VAR>number</VAR> は失敗する直前に割り当てられたメモリー (K バイト) です。
<P>これらの厳しい制限の範囲内で、適切なキャッシュ・サイズを決定する要素は、そのマシンで作業するユーザーの数、通常ユーザーが作業に使用するファイルのサイズ、および (メモリー・キャッシュに対して) マシン上で通常実行されるプロセスの数です。これらの要素の要求が高ければ高いほど、良いパフォーマンスを維持するために必要なキャッシュのサイズは大きくなります。
<P>10 MB より少ないディスク・キャッシュは、一般にパフォーマンスがよくありません。複数のユーザーにサービスを提供するマシンでは、最低 60 から 70 MB のキャッシュを使用すると、一般にパフォーマンスが良くなります。キャッシュをさらに大きくした場合でも、パフォーマンスが実際に向上するかどうかは上記で説明した要素によって異なり、予測するのは困難です。
<P>サイズが 1 MB より小さいメモリー・キャッシュは機能せず、サイズが 5 MB より小さいキャッシュのパフォーマンスはたいていの場合不十分です。適切な上限はディスク・キャッシュの場合とほとんど同じですが、マシン上のその他のソース (ユーザーおよびプロセスの数) からの要求の影響をより多く受けます。少数のプロセスのみを実行するマシンでは、これより小さいメモリー・キャッシュを使用することができます。
<P>一部のバージョンでは、AFS は、キャッシュ・サイズに絶対限度を課します。使用しているバージョンについての<I>AFS Release Notes</I>を参照してください。
<P><B></B>
<P><H3><A NAME="HDRWQ542" HREF="auagd002.htm#ToC_439">キャッシュのサイズおよびロケーションの表示および設定</A></H3>
<A NAME="IDX7351"></A>
<A NAME="IDX7352"></A>
<A NAME="IDX7353"></A>
<A NAME="IDX7354"></A>
<A NAME="IDX7355"></A>
<A NAME="IDX7356"></A>
<A NAME="IDX7357"></A>
<A NAME="IDX7358"></A>
<A NAME="IDX7359"></A>
<A NAME="IDX7360"></A>
<A NAME="IDX7361"></A>
<A NAME="IDX7362"></A>
<A NAME="IDX7363"></A>
<A NAME="IDX7364"></A>
<A NAME="IDX7365"></A>
<A NAME="IDX7366"></A>
<A NAME="IDX7367"></A>
<A NAME="IDX7368"></A>
<A NAME="IDX7369"></A>
<A NAME="IDX7370"></A>
<A NAME="IDX7371"></A>
<P>キャッシュ・マネージャーは、初期化の際に <B>/usr/vice/etc/cacheinfo</B> ファイルを読み取り、キャッシュのサイズを決定します。<I>AFS インストールの手引き</I> に記載されているように、
<B> afsd</B> プログラムを実行する前にこのファイルを作成する必要があります。このファイルはさらに、AFS (慣例では、<B>/afs</B>) をマウントするディレクトリー、およびキャッシュ・ディレクトリーとして使用するローカル・ディスクのディレクトリーを定義します。
<P>このファイル内の任意の値を変更するには、ローカル・スーパーユーザー <B>root</B> としてログインします。新しい値を有効にするためにはマシンをリブートする必要があります。説明については、<A HREF="#HDRWQ545">cacheinfo ファイルを編集する</A>を参照してください。
<P><B>cacheinfo</B> ファイルを編集せずにリブート時にキャッシュ・サイズを変更するには、
<B>afsd</B> コマンドで <B>-blocks</B> 引き数を指定します。
<I>AFS Administration Reference</I> のコマンド参照ページを参照してください。
<P>ディスク・キャッシュに対しては、
<B>fs setcachesize</B> コマンドを使用して、リブートせずにキャッシュ・サイズをリセットすることができます。設定した値は、次のリブート時まで維持されます。キャッシュ・サイズは、リブート時には <B>cacheinfo</B> ファイルで指定した値、または <B>afsd</B> コマンドの <B>-blocks</B> 引き数によって指定した値に戻ります。説明については、<A HREF="#HDRWQ546">リブートせずにディスク・キャッシュ・サイズを変更する</A>を参照してください。
<P>現行のキャッシュ・サイズおよび現時点でキャッシュ・マネージャーが使用しているスペースの大きさを表示するには、
<A HREF="#HDRWQ544">現行のキャッシュ・サイズを表示する</A>での説明している <B>fs getcacheparms</B> コマンドを使用してください。
<P><H3><A NAME="HDRWQ543" HREF="auagd002.htm#ToC_440">リブート時のキャッシュ・サイズの設定を表示する</A></H3>
<OL TYPE=1>
<LI>テキスト・エディターまたは <B>cat</B> コマンドを使用して、
<B>/usr/vice/etc/cacheinfo</B> ファイルの内容を表示します。
<P>
<PRE>   % <B>cat /usr/vice/etc/cacheinfo</B>
</PRE>
</LI></OL>
<A NAME="IDX7372"></A>
<A NAME="IDX7373"></A>
<A NAME="IDX7374"></A>
<A NAME="IDX7375"></A>
<A NAME="IDX7376"></A>
<A NAME="IDX7377"></A>
<P><H3><A NAME="HDRWQ544" HREF="auagd002.htm#ToC_441">現行のキャッシュ・サイズを表示する</A></H3>
<OL TYPE=1>
<LI>クライアント・マシン上で <B>fs getcacheparms</B> コマンドを発行します。
<P>
<PRE>   % <B>fs getcacheparms</B>
</PRE>
<P>
<P>ここで、
<B>getca</B> は、<B>getcacheparms</B> の受け入れ可能な省略形です。
<P>
<P>出力は、コマンドを発行した時点でキャッシュ・マネージャーがキャッシュとして使用しているブロックの K バイトの数値を示します。たとえば、次のようになります。
<P>
<PRE>   AFS using 13709 of the cache's available 15000 1K byte blocks.
</PRE>
</LI></OL>
<A NAME="IDX7378"></A>
<A NAME="IDX7379"></A>
<A NAME="IDX7380"></A>
<A NAME="IDX7381"></A>
<A NAME="IDX7382"></A>
<P><H3><A NAME="HDRWQ545" HREF="auagd002.htm#ToC_442">cacheinfo ファイルを編集する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI>テキスト・エディターを使用して、<B>/usr/vice/etc/cacheinfo</B> ファイルを編集します。このファイルには、コロンで区切られた 3 つのフィールドがあります。
<UL>
<LI>最初のフィールドは、AFS ファイル・スペースをマウントするローカル・ディレクトリーの名前を指定します。通常の位置は、<B>/afs</B> です。
</LI><LI>2 番目のフィールドは、ディスク・キャッシュで使用するローカル・ディスク・ディレクトリーを定義します。通常の位置は <B>/usr/vice/cache</B> ディレクトリーですが、他の区画の使用可能スペースが多ければ代わりのディレクトリーを指定することができます。このフィールドには必ず値を指定する必要がありますが、マシンでメモリー・キャッシュを使用する場合は、キャッシュ・マネージャーはこの値を無視します。
</LI><LI>3 番目のフィールドは、キャッシュ・サイズをブロックの K バイト (1024 バイト) の数値で定義します。
</LI></UL>
<P>
<P>次の例では、AFS ファイル・スペースを <B>/afs</B> ディレクトリーにマウントし、キャッシュ・ディレクトリーとして <B>/usr/vice/cache</B> と命名し、キャッシュ・サイズを 50,000 KB に設定しています。
<P>
<PRE>      <B>/afs:/usr/vice/cache:50000</B>
</PRE>
</LI></OL>
<A NAME="IDX7383"></A>
<A NAME="IDX7384"></A>
<A NAME="IDX7385"></A>
<A NAME="IDX7386"></A>
<A NAME="IDX7387"></A>
<A NAME="IDX7388"></A>
<P><H3><A NAME="HDRWQ546" HREF="auagd002.htm#ToC_443">リブートせずにディスク・キャッシュ・サイズを変更する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><A NAME="LIWQ547"></A><B>fs setcachesize</B> コマンドを発行して、新しいディスク・キャッシュ・サイズを設定します。
<P>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">このコマンドはメモリー・キャッシュでは機能しません。
</TD></TR></TABLE>
<P>
<PRE>   # <B>fs setcachesize</B> &lt;<VAR>size in 1K byte blocks (0 => reset)</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>setca</B>
</B><DD>は、<B>setcachesize</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>size in 1K byte blocks (0 => reset)</VAR>
</B><DD>キャッシュで使用するブロックの K バイトの数値を設定します。正の整数 (<B>1024</B> は 1 MB になります) または <B>0</B> (ゼロ) を指定して、キャッシュ・サイズを <B>cacheinfo</B> ファイルで指定した値にリセットします。
</DL>
</LI></OL>
<A NAME="IDX7389"></A>
<A NAME="IDX7390"></A>
<A NAME="IDX7391"></A>
<A NAME="IDX7392"></A>
<A NAME="IDX7393"></A>
<A NAME="IDX7394"></A>
<P><H3><A NAME="Header_444" HREF="auagd002.htm#ToC_444">リブートせずにディスク・キャッシュ・サイズをデフォルトの設定にリセットする</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>fs setcachesize</B> コマンドを発行して、ローカル・ディスク・キャッシュのサイズをリセットします
(このコマンドはメモリー・キャッシュでは機能しません)。次のいずれかのオプションを選択します。
<UL>
<LI>ローカルな <B>cacheinfo</B> ファイルで指定した値にキャッシュ・サイズをリセットする場合は、値 <B>0</B> (ゼロ) を指定する
<P>
<PRE>   # <B>fs setcachesize 0</B>
</PRE>
</LI><LI>マシンを最後にリブートしたときに設定された値にキャッシュ・サイズをリセットする場合は、
<B>-reset</B> フラグを指定する。<B>afsd</B> コマンドで <B>-blocks</B> 引き数を使用しない場合は、この値も <B>cacheinfo</B> ファイルで指定した値になります。
<P>
<PRE>   # <B>fs setcachesize -reset</B>
</PRE>
</LI></UL>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>setca</B>
</B><DD>は、<B>setcachesize</B> の受け入れ可能な省略形です。
<P><DT><B>0
</B><DD>ディスク・キャッシュ・サイズを <B>/usr/vice/etc/cacheinfo</B> ファイルの 3 番目のフィールドの値にリセットします。
<P><DT><B>-reset
</B><DD>キャッシュ・サイズを最後のリブート時に設定された値にリセットします。
</DL>
</LI></OL>
<P><H3><A NAME="HDRWQ548" HREF="auagd002.htm#ToC_445">キャッシュ・マネージャーが廃棄するデータを選択する方法</A></H3>
<P>キャッシュがフルでアプリケーション・プログラムが AFS からさらにデータを要求するとき、キャッシュ・マネージャーは、データ用の空きを作るためにキャッシュ・チャンクをフラッシュする必要があります。キャッシュ・マネージャーは、次の 2 つの要素を考慮します。
<OL TYPE=1>
<LI>アプリケーションがデータに最後にアクセスしたのはどれくらい最近か。
</LI><LI>チャンクは<I>ダーティー</I> かどうか。ダーティーなチャンクには、ファイル・サーバー・マシンに格納されている永久コピーにまだ保管されていないファイルに対する変更が含まれています。
</LI></OL>
<P>キャッシュ・マネージャーは、最も遠い最近に使用されたチャンクを最初にチェックします。チャンクがダーティーではない場合は、キャッシュ・マネージャーはそのチャンク内のデータを廃棄します。チャンクがダーティーである場合、キャッシュ・マネージャーは次に新しく使用されたチャンクのチェックするために移動します。キャッシュ・マネージャーは、十分な数の空のチャンクを作成するまで、この方法でチェックを続けます。
<P>読み取り専用ボリュームからフェッチされたデータを含むチャンクは、定義により、ダーティーになることはありません。したがって、キャッシュ・マネージャーは常にこのようなチャンクを廃棄することができます。通常、キャッシュ・マネージャーは、読み取り / 書き込みボリュームからフェッチしたダーティーでないデータのチャンクを見付けることもできますが、キャッシュが小さい場合は、適切なデータを十分見付けることは難しくなります。キャッシュ・マネージャーが廃棄できるデータを何も見つけることができない場合は、
AFS からデータをさらに要求するアプリケーション・プログラムに対して、キャッシュ・マネージャーは入出力エラーを返します。通常、アプリケーション・プログラムにはそのようなエラーをユーザーに通知する機能は備わっていますが、エラーの原因は表示されません。
<HR><H2><A NAME="HDRWQ549" HREF="auagd002.htm#ToC_446">afsd プログラムを使用してその他のパラメーターを設定する</A></H2>
<P>設定する必要があるキャッシュ構成パラメーターは、
AFS のマウント・ディレクトリー、ディスク・キャッシュ・ディレクトリーのロケーション、およびキャッシュ・サイズの 3 つです。これらのパラメーターは、
<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>で説明した <B>/usr/vice/etc/cacheinfo</B> ファイル内の 3 つのフィールドに対応しています。ただし、キャッシュ・パフォーマンスがよくなるように調整を行う場合は、
<B>afsd</B> コマンドに引き数を指定してその他のパラメーターを制御することができます。この節では、そのパラメーターの中でキャッシュ・パフォーマンスに最も直接的に影響するいくつかのものを説明します。
<B>afsd</B> コマンドの引き数について確認するには、
<I>AFS Administration Reference</I>の参照ページを参照してください。
<P>また、各システム・タイプの AFS の配布に含まれる AFS 初期設定スクリプトには、複数の <B>afsd</B> 引き数を異なるサイズおよび使用パターンのクライアント・マシンに適合するよう設定する変数がいくつか組み込まれています。スクリプトの最適な使用方法についての説明は、
<I>AFS インストールの手引き</I> のキャッシュ・マネージャーの構成セクションを参照してください。
<P><H3><A NAME="HDRWQ550" HREF="auagd002.htm#ToC_447">キャッシュ構成パラメーターの設定</A></H3>
<P>キャッシュのパフォーマンスに最も直接的に影響するキャッシュ構成パラメーターは、以下のとおりです。
<UL>
<LI><I>total cache size</I>。これは、
<A HREF="#HDRWQ541">キャッシュ・タイプ、サイズ、およびロケーションを決定する</A>で詳細を説明したように、ディスク・スペースまたはキャッシュに使用できるマシン・メモリーの大きさです。
</LI><LI><I>number of cache chunks</I>。ディスク・キャッシュでは、各チャンクはローカル・キャッシュ・ディレクトリー内の 1 つの <B>V file</B><VAR>n</VAR> です
(<A HREF="#HDRWQ540">キャッシュ関連ファイル</A>を参照してください)。メモリー・キャッシュでは、各チャンクはマシン・メモリー内に割り振られた連続ブロックの集合です。
<P>
<P>このパラメーターは、キャッシュのパフォーマンスに対して total size 程影響を与えません。しかしながら、このパラメーターを調整すると、キャッシュ・マネージャーが新しいデータのスペースを確保するためにキャッシュされたデータを廃棄する回数に影響します。たとえば、ディスク・キャッシュ・サイズを 50 MB に設定し、チャンクの数 (<B>V</B><VAR>n</VAR> ファイル) を 1,000 に設定すると仮定します。マシン上の 10人 のユーザーのそれぞれが、平均 20 KB のサイズを持つ 100 個の AFS ファイルをキャッシュした場合、
1,000 のチャンクはすべてフル (1 つのチャンクには 1 つの AFS からのデータだけを含むことができる) ですが、キャッシュは約 20 MB のデータだけを保持します。ユーザーがファイル・サーバーからさらにデータを要求すると、キャッシュの容量の 50% 以下までしか使用されていないにもかかわらず、キャッシュ・マネージャーはいくつかのチャンク・ファイルを再利用するために、キャッシュされたデータを廃棄する必要があります。このような状態では、チャンクの数を増やすと、キャッシュ・マネージャーがデータを廃棄する回数を減らすことができます。
</LI><LI><I>chunk size</I>。このパラメーターは、チャンクに格納することができる最大データ量を決定します。キャッシュされる 1 つの要素の大きさがチャンク・サイズより小さい場合は、チャンクの残りのスペースは使用されません (チャンクは 1 つの要素だけを保持します)。ある要素が 1 つのチャンクに収まらない場合は、分割されて必要な数のチャンクに入れられます。このパラメーターはまた、キャッシュ・マネージャーが 1 回にどれだけのデータをファイル・サーバーから要求するかを決定します
(AFS が部分的なファイル転送を使用するため、<I>RPCのフェッチ</I> ごとのデータの量)。
<P>
<P>チャンクのサイズを変更する主な理由は、チャンク・サイズが RPC ごとにフェッチするデータの量と関連しているからです。非常に高速のネットワーク・リンクの場合、そのネットワーク・リンクは、チャンク・サイズを増加するとパフォーマンスを向上させることができます。非常に低速のネットワークの場合は、チャンク・サイズを削減するのが最善です。
</LI><LI><I>number of dcache entries in memory</I>。キャッシュ・マネージャーは、チャンクに対応する AFS ファイルの ID(fID) およびバージョン番号などを含む小さいサイズの情報を記録して、各キャッシュ・チャンクに対して 1 つの dcache 項目を保持します。
<P>
<P>ディスク・キャッシュの場合は、dcache 項目は <B>/usr/vice/cache/CacheItems</B> に常駐します。少数の項目が、アクセスを速めるためにマシン・メモリーで複製されます。
<P>
<P>メモリー・キャッシュの場合、dcache 項目の数はキャッシュ・チャンクの数と一致します。この問題の言外の意味についての説明は、<A HREF="#HDRWQ552">メモリー・キャッシュ構成を制御する</A> を参照してください。
</LI></UL>
<P>キャッシュ・マネージャーがどのようにディスク・キャッシュ内のチャンクの数、チャンク・サイズ、および dcache 項目の数のデフォルトを決定するかについての説明は、
<A HREF="#HDRWQ551">ディスク・キャッシュの構成</A> を参照してください。メモリー・キャッシュについては、<A HREF="#HDRWQ552">メモリー・キャッシュ構成を制御する</A> を参照してください。この説明では、デフォルトを上書きするための <B>afsd</B> コマンドの使用方法についても説明しています。
<P><H3><A NAME="HDRWQ551" HREF="auagd002.htm#ToC_448">ディスク・キャッシュの構成</A></H3>
<P>ディスク・キャッシュ内のキャッシュ・チャンク (<B>V</B><VAR>n</VAR> ファイル) の数のデフォルトは、
<B>afsd</B> コマンドを使用して計算され、以下の数値の中で最大のものと一致します。
<UL>
<LI>100
</LI><LI>キャッシュ・サイズをチャンク・サイズで除算した結果の 1.5 倍 (<VAR>キャッシュ・サイズ</VAR>/<VAR>チャンク・サイズ</VAR> * 1.5)
</LI><LI>キャッシュ・サイズを 10 MB で除算した結果 (<VAR>キャッシュ・サイズ</VAR>/10240)
</LI></UL>
<P>この値は、<B>-files</B> 引き数に正の整数を指定することにより上書きすることができます。キャッシュ・マネージャーが初期設定を完了したすぐ後に、
<B>V</B><VAR>n</VAR> ファイルの 75% 以上が既に使用されている場合は、この値を増やすことを検討してください。その時点で、小さな割合のチャンクだけが使用される場合は、値を減らすことを検討してください。いずれの場合も、
100 より少ない値を指定しないでください。小さい値を指定すると、パフォーマンスの問題が生じることがあるからです。
<P>次の例は、<B>V</B><VAR>n</VAR> ファイルの数を 2,000 に設定します。
<PRE>      <B>/usr/vice/etc/afsd -files 2000</B>
</PRE>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">標準的には、<B>afsd</B> コマンドを、コマンド・シェルに入力する代わりに、マシンの AFS 初期設定ファイルに組み込みます。また、この機能グループで指定する値は、例にすぎず、必ずしも特定のマシンに適してはいません。
</TD></TR></TABLE>
<P>ディスク・キャッシュのデフォルトのチャンク・サイズは 64 KB です。一般に、チャンク・サイズを変更するのは、特に遅いか速いネットワークを調整する場合のみです。<A HREF="#HDRWQ550">キャッシュ構成パラメーターの設定</A> を参照してください。<B>-chunksize</B> 引き数を使用してデフォルトを上書きすることができます。チャンク・サイズは 2 の指数でなければなりません。
2 の指数として使用するために、0 (ゼロ) から 30 までの間の整数を指定します。たとえば、値 10 を指定すると、チャンク・サイズは 1 KB (2<SUP>10</SUP> = 1024) に設定されます。値 16 は、メモリー・キャッシュのデフォルト値 (2<SUP>16</SUP> = 64 KB) と等しくなります。0 (ゼロ) または 30 より大きい値は、チャンク・サイズをデフォルトに戻します。10 (1 KB) より少ない値は避けてください。次の例は、チャンク・サイズを 16 KB (2<SUP>14</SUP>) に設定します。
<PRE>      <B>/usr/vice/etc/afsd -chunksize 14</B>
</PRE>
<P>ディスク・キャッシュの場合は、メモリー内に複製される dcache 項目の数は、
<B>-files</B> 引き数を使用して指定するチャンクの数の 2 分の 1、最大 2,000 項目までです。<B>-dcache</B> 引き数を使用して、デフォルトを変更することができます。必要な場合は、2,000 を超えることもできます。通常はメモリー内の dcache 項目の半分以上を複製することは必要ありませんが、メモリーへのアクセスの方がディスクへのアクセスよりも高速であるため、わずかにパフォーマンスが向上する場合があります。次の例は、ファイルの数を 750 に設定します。
<PRE>      <B>/usr/vice/etc/afsd -dcache 750</B>
</PRE>
<P>ディスク・キャッシュを構成するとき、<B>afsd</B> コマンドの引き数を任意の方法で組み合わせることができます。このように柔軟性があるのは、ディスク・キャッシュに対して指定した設定 (<B>cacheinfo</B>内または<B> -blocks</B> 引き数を使用した場合) が絶対的な上限だからです。<B>-files</B> または <B>-chunksize</B> 引き数を単独でまたは組み合わせて使用して、もっと高い値を指定することにより、この値を上書きすることはできません。他の理由としては、キャッシュ・マネージャーがディスク上に一定のメモリーを予約する必要がないためです。<B>V</B><VAR>n</VAR> ファイル (ディスク・キャッシュ内のチャンク) は初期設定では 0 の大きさですが、必要に応じて指定したチャンク・サイズに拡張したり、再び縮小したりすることができます。V ファイルの数に大きな値を設定すると、それぞれの <B>V</B><VAR>n</VAR> ファイルが最大サイズまで拡張され、その結果合計キャッシュ・サイズを超えてしまいます。したがって、V ファイルが最大サイズまで拡張されることはありません。
<P><H3><A NAME="HDRWQ552" HREF="auagd002.htm#ToC_449">メモリー・キャッシュ構成を制御する</A></H3>
<P>メモリー・キャッシュの構成は、
<B>afsd</B> コマンドの引き数のすべての組み合わせを使用できない点において、ディスク・キャッシュを構成する場合と異なっています。この制限は、メモリー・キャッシュではディスク・キャッシュよりも構成パラメーターが相互に作用するために生じます。仮にすべての組み合わせを使用できたとしても、パラメーターが互いに矛盾するやり方で設定してしまう可能性があります。デフォルト値の説明の後に、許容可能および受諾不能の組み合わせのリストを示します。
<P>メモリー・キャッシュのデフォルトのチャンク・サイズは 8 KB です。一般に、チャンク・サイズを変更するのは、特に遅いか速いネットワークを調整する場合のみです。<A HREF="#HDRWQ550">キャッシュ構成パラメーターの設定</A> を参照してください。
<P>メモリー・キャッシュのチャンクの数に対して事前に定義されたデフォルトはありません。代わりに、キャッシュ・マネージャーが合計キャッシュ・サイズをチャンクの数で除算して正しい数を計算します。メモリー・キャッシュの場合は、すべての dcache 項目がメモリー内に存在する必要があることを思い出してください。このことは、チャンクの数がメモリー内の dcache 項目の数と一致し、
dcache 項目の数のデフォルトが存在しないことを意味します
(チャンクの数と同様に、dcache 項目の数は合計サイズをチャンク・サイズで除算して計算されます)。
<P>メモリー・キャッシュを構成するときに許容可能な <B>afsd</B> コマンドの組み合わせは次のとおりです。
<UL>
<LI><B>-blocks</B> のみ。この引き数は、<B>/usr/vice/etc/cacheinfo</B> で指定されたデフォルトのキャッシュ・サイズを上書きします。キャッシュ・マネージャーは、この引き数の値をデフォルトのチャンク・サイズである eight KB で除算してチャンクおよび dcache 項目の数を計算します。次の例は、キャッシュ・サイズを 5 MB (5,120 KB)、およびチャンクの数を 640 (5120 を 8 で除算する) に設定します。
<P>
<PRE>      <B>/usr/vice/etc/afsd -memcache -blocks 5120</B>
</PRE>
</LI><LI><B>-chunksize</B> のみは、8 KB のデフォルトを上書きします。チャンク・サイズは 2 の指数でなければなりません。
2 の指数として使用するために、0 (ゼロ) から 30 までの間の整数を指定します。たとえば、値 10 を指定すると、チャンク・サイズは 1 KB (2<SUP>10</SUP> = 1024) に設定されます。値 13 は、メモリー・キャッシュのデフォルト値 (2<SUP>13</SUP> = 8 KB) と等しくなります。0 (ゼロ) または 30 より大きい値は、チャンク・サイズをデフォルトに戻します。10 (1 KB に相当) より少ない値は避けてください。次の例は、チャンク・サイズを 4 KB (2<SUP>12</SUP>) に設定します。合計キャッシュ・サイズが 4 MB (4096 KB) であるため、チャンクの数は 1024 になります。
<P>
<PRE>      <B>/usr/vice/etc/afsd -memcache -chunksize 12</B>
</PRE>
</LI><LI><B>-blocks</B> および <B>-chunksize</B> を共に指定すると、キャッシュ・サイズとチャンク・サイズのデフォルトが上書きされます。キャッシュ・マネージャーは、最初の引き数の値を 2 番目の引き数の値で除算してチャンクおよび dcache 項目の数を計算します。たとえば、次の例は、キャッシュ・サイズを 6 MB (6144 KB)、そしてチャンク・サイズを 4 KB (2<SUP>12</SUP>) に設定し、その結果は 1,536 チャンクになります。
<P>
<PRE>      <B>/usr/vice/etc/afsd -memcache -blocks 6144 -chunksize 12</B>
</PRE>
</LI></UL>
<P>以下の組み合わせは、チャンクおよび dcache 項目の数を明示的に設定します。これらの組み合わせは、キャッシュ・サイズを間接的に設定し、キャッシュのサイズを決定するためにシステム管理者が手で計算する必要があるため、使用することをお勧めしません。代わりに、<B>-blocks</B> および
<B>-chunksize</B> 引き数を、単独でまたは組み合わせて設定します。この場合、キャッシュ・マネージャーが、チャンクの数と dcache 項目自体を決定します。これらの組み合わせはお勧めしないため、例は示しません。
<UL>
<LI><B>-dcache</B> 引き数は、チャンクおよび dcache 項目の数を明示的に設定します。キャッシュ・マネージャーは、この値とデフォルトのチャンク・サイズである 8 KB を乗算して合計キャッシュ・サイズを求めます
(<B>cacheinfo</B> 内の値を上書きします)。
</LI><LI><B>-dcache</B> および <B> -chunksize</B> の組み合わせは、チャンクの数およびサイズを設定します。キャッシュ・マネージャーは、指定した値を設定し、2 つの引き数の値を乗算して合計キャッシュ・サイズを求めます
(<B>cacheinfo</B> ファイル内の値を上書きします)。
</LI></UL>
<P>メモリー・キャッシュに対して、以下の引き数を使用しないでください。
<UL>
<LI><B>-files</B> のみ。この引き数は、ディスク・キャッシュの <B>V</B><VAR>n</VAR> ファイルの数を制御しますが、メモリー・キャッシュに対して指定された場合は無視されます。
</LI><LI><B>-blocks</B> および <B>-dcache</B>。エラー・メッセージが表示されます。最初の引き数 (合計サイズ) を 2 番目の引き数 (チャンクの数) で除算すると、
2 の累乗でないチャンク・サイズになる値を指定する可能性があるためです。
</LI></UL>
<HR><H2><A NAME="HDRWQ553" HREF="auagd002.htm#ToC_450">データベース・サーバー・マシンの情報を保持する</A></H2>
<A NAME="IDX7395"></A>
<A NAME="IDX7396"></A>
<A NAME="IDX7397"></A>
<A NAME="IDX7398"></A>
<A NAME="IDX7399"></A>
<A NAME="IDX7400"></A>
<A NAME="IDX7401"></A>
<A NAME="IDX7402"></A>
<A NAME="IDX7403"></A>
<P>AFS クライアント・マシンのユーザーが、セルの AFS ファイル・スペースおよびその他のサービスにアクセスする場合は、キャッシュ・マネージャーおよびその他のクライアント側のエージェントが、セル内のデータベース・サーバー・マシンの正確なリストを保持する必要があります。関連する機能は以下のとおりです。
<UL>
<LI>ファイルのアクセス。キャッシュ・マネージャーは、要求されたファイルまたはディレクトリーを含むボリュームが常駐するファイル・サーバー・マシンを確認するために、ボリューム・ロケーション (VL)・サーバーに接続します。キャッシュ・マネージャーがセルの VL サーバーに接続できない場合は、キャッシュ・マネージャーはファイルをフェッチすることができません。
</LI><LI>認証。
<B>klog</B> プログラムおよび修正 AFS ログイン・ユーティリティーは、認証サーバーに接続してトークンを入手します。
AFS サーバー・プロセスはこのトークンをユーザーが認証された証拠として受信します。
</LI><LI>保護グループの作成。
<B>pts</B> コマンド解釈プログラムは、ユーザーが保護グループを作成するとき、または保護データベースに情報を要求するときに保護サーバーに接続します。
</LI><LI>アクセス制御リスト (ACL) の編集。
<B>fs</B> コマンド・インタープリターは、ファイルまたはディレクトリーを含む読み取り / 書き込みボリュームを保持するファイル・サーバーに接続します。ロケーション情報は VL サーバーから入手します。
</LI></UL>
<P>あるマシンのユーザーがあるセルにアクセスできるようにするためには、システム管理者はそのセルのデータベース・サーバー・マシンの名前および IP アドレスを、そのマシンのローカル・ディスク上の <B>/usr/vice/etc/CellServDB</B> ファイルにリストする必要があります。マシンのホーム・セルの他に、ユーザーがアクセスするための任意の外部セルをリストすることができます。
(セルのファイル・スペースへのアクセスを可能にするためには、セルの <B>root.cell</B> ボリュームをローカル AFS ファイル・スペースにマウントする必要があります。ローカル AFS ファイル・スペースは、慣例として AFS ルート・ディレクトリー <B>/afs</B> のすぐ下に配置されています。説明については、<I>AFS インストールの手引き</I> を参照してください。)
<P><H3><A NAME="Header_451" HREF="auagd002.htm#ToC_451">クライアントがデータベース・サーバー・マシンのリストを使用する方法</A></H3>
<P><B>afsd</B> プログラムが実行されてキャッシュ・マネージャーが初期化されると、キャッシュ・マネージャーは <B>CellServDB</B> ファイルの内容を読み取ってカーネル・メモリーに入れます。キャッシュ・マネージャーは、マシンが次にリブートされるまでは再度そのファイルを調べることはありません。対照的に、AFS コマンドの組みに使用するコマンド解釈プログラム
(<B>fs</B> および <B>pts</B> など) は、データベース・サーバー・プロセスに接続する必要があるたびに
<B>CellServDB</B> ファイルを読み取ります。
<P>セルのデータベース・サーバー・マシンのリストが変更されると、整合性のあるクライアントのパフォーマンスを確保するためには、
<B>CellServDB</B> ファイルおよびカーネル・メモリー内のリストの両方を変更する必要があります。<B>CellServDB</B> ファイルおよびカーネル・メモリーの両方を更新する方法として可能な方法の 1 つは、ファイルを編集した後でマシンをリブートすることです。リブートすることを省略するためには、代わりに以下の両方の操作を実行します。
<OL TYPE=1>
<LI><B>fs newcell</B> コマンドを発行して、カーネル・メモリー内のリストを直接変更することによりキャッシュ・マネージャーが変更されたデータを使用できるようにします。
</LI><LI><B>CellServDB</B> ファイルを編集して、コマンド解釈プログラムが変更されたデータを使用できるようにします。ファイル形式の説明については、<A HREF="#HDRWQ554">CellServDB ファイルの形式</A>を参照してください。
</LI></OL>
<P><B>CellServDB</B> ファイルまたはカーネル・メモリー内での情報の脱落または誤りは、以下の結果をもたらします。
<UL>
<LI>セル内に全く項目がない場合は、マシンのユーザーはそのセルにアクセスできません。
</LI><LI>セルの項目に、あるデータベース・サーバー・マシンの情報が組み込まれていない場合、キャッシュ・マネージャーおよびコマンド・インタープリターはそのデータベース・サーバー・マシンと交信しようとしません。ただし、その他のデータベース・サーバー・マシンの情報が正しく、かつサーバー・プロセス、マシン、およびネットワークが正常に機能している場合は、
1 つのデータベース・サーバー・マシンの情報が省略されても、セルへのアクセスができなくなることはありません。リストされたすべてのマシンがクライアントにアクセスできなくなった場合は、省略されたサーバー・マシンがたとえ正常に機能していても、セルにアクセスすることができなくなります。
</LI><LI>マシン名またはアドレスが正しくない場合、またはリストされているマシン上で実際にはデータベース・サーバー・プロセスが実行されていない場合は、クライアントからの要求はタイムアウトになります。ユーザーは、キャッシュ・マネージャーまたはコマンド解釈プログラムが、別のデータベース・サーバー・マシンに接続するまでのタイムアウトになっている期間は待機しなければならないため、長い遅延を経験することになります。
</LI></UL>
<P><H3><A NAME="HDRWQ554" HREF="auagd002.htm#ToC_452">CellServDB ファイルの形式</A></H3>
<A NAME="IDX7404"></A>
<A NAME="IDX7405"></A>
<P><B>/usr/vice/etc/CellServDB</B> ファイルを編集する際には、セルおよびマシンの項目に対して正しい形式を使用する必要があります。各セルには分離された項目があります。
1 行目の形式は次のとおりです。
<PRE>   ><VAR>cell_name</VAR>      #<VAR>organization</VAR>
</PRE>
<P>ここで、<VAR>cell_name</VAR> は、セルの完全インターネット・ドメイン名であり (たとえば、<B>example.com</B>)、<VAR>organization</VAR> は任意の数のスペースおよび番号記号 (<TT>#</TT>) の後に続く任意指定フィールドであり、セルが対応している組織の名前を指定することができます (たとえば、Example Corporation)。1 行目の後には、各データベース・サーバー・マシンを示す分離された行が続きます。各行の形式は次のとおりです。
<PRE>      <VAR>IP_address</VAR>   #<VAR>machine_name</VAR>
</PRE>
<P>ここで、<VAR>IP_address</VAR> は、小数点付き 10 進数形式のマシンの IP アドレスです (たとえば、192.12.105.3)。任意の数のスペースおよび番号記号 (<TT>#</TT>) の後に続くのは、マシンの完全に修飾されたホスト名を示す <VAR>machine_name</VAR> です (たとえば、<B>db1.example.com</B>)。この場合、番号記号はコメントを示しているわけではなく、
<VAR> machine_name</VAR> は必須フィールドです。
<P>セルが表示される順序は重要ではありませんが、クライアント・マシンのホーム・セルを最初に表示すると便利です。ファイルには、何もブランク行を入れないでください。最後の項目の後にもブランク行を入れてはなりません。
<P>以下の例は、それぞれのセルに 3 つのデータベース・サーバー・マシンが存在する 2 つのセルの項目を示します。
<PRE>   >example.com       #Example Corporation (home cell)
   192.12.105.3      #db1.example.com
   192.12.105.4      #db2.example.com
   192.12.105.55     #db3.example.com
   >example.org    #Example Organization cell
   138.255.68.93     #serverA.example.org
   138.255.68.72     #serverB.example.org
   138.255.33.154    #serverC.example.org
</PRE>
<P><H3><A NAME="HDRWQ555" HREF="auagd002.htm#ToC_453">クライアントの CellServDB ファイルの保守</A></H3>
<A NAME="IDX7406"></A>
<A NAME="IDX7407"></A>
<P>整合性のあるクライアントのパフォーマンスを実現するためには、
<B>CellServDB</B> ファイル内の項目が正しいことが不可欠であるため、セル内のデータベース・サーバー・マシンのリストが変更されたときには常に、各クライアント・マシン上のファイルも更新する必要があります。
(たとえば、<I>AFS インストールの手引き</I> に記載されている説明に従ってデータベース・サーバー・マシンを追加または削除したときなどです。)クライアントの更新を行うためには、
<B>パッケージ</B>・プログラムを使用することができます。このプログラムは、AFS の中央ソースのファイルをクライアント・マシンのローカル・ディスクにコピーします。標準的には、マシンのリブート時に実行されるように、クライアント・マシン上の AFS 初期設定ファイル内の<B>パッケージ</B>・プログラムを起動しますが、必要なときにいつでも <B>package</B> コマンドを実行することも可能です。説明については、<A HREF="auagd016.htm#HDRWQ601">パッケージ・プログラムの実行</A>を参照してください。
<P><B>パッケージ</B>・プログラムを使用する場合は、所属するセルの中央ソースである <B>CellServDB</B> ファイルは
<B>/afs/</B><VAR>cell_name</VAR><B>/common/etc/CellServDB</B> です。ここで、<VAR>cell_name</VAR> は、所属するセル名です。
<A NAME="IDX7408"></A>
<P><B>/usr/vice/etc/CellServDB</B> を、
AFS 内の中央ソースのシンボリック・リンクまたはハード・リンクとして作成することはできません。<B>afsd</B> プログラムは、キャッシュ・マネージャーが完全に初期化され、
AFS にアクセスできるようになる前にそのファイルを読み取ってカーネル・メモリーに入れます。
<P>各クライアント・マシンは、<B> CellServDB</B> ファイルの独自のコピーを持っているため、論理的にはそれぞれのマシン上で異なるアクセス可能なセルの集合を作成することができます。しかしながら、ほとんどの場合、セル内のすべてのクライアント・マシン上のファイル間で整合性を保つことが最も良い方法です。マシン間での差は、ユーザーが通常は 1 つではなくさまざまなマシンを使用する場合は特に混乱を招きます。
<P>AFS 製品サポート・グループは、中央 <B>CellServDB</B> ファイルを保持します。このファイルは、セル内のデータベース・サーバー・マシンが他の AFS セルにアクセスすることを許可するすべてのセルをリストします。このファイルと定期的に検査して、更新情報を調べることをお勧めします。<A HREF="auagd007.htm#HDRWQ39">ユーザーのセルをほかのユーザーが見ることができるようにする</A> を参照してください。
<A NAME="IDX7409"></A>
<P>ローカルの <B>CellServDB</B> の項目は、セルにアクセスするための 2 つの要件の 1 つです。もう1 つの要件は、セルの <B>root.cell</B> ボリュームは、標準では <B>/afs</B> ディレクトリーのサブディレクトリーとして、ローカルのファイル・スペースに取り付けられている、というものです。説明については、<A HREF="auagd010.htm#HDRWQ299">セルラー・マウント・ポイントを作成する方法</A> を参照してください。
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">クライアント・マシン上の <B>/usr/vice/etc/CellServDB</B> ファイルが、ファイル・サーバー・マシンのローカル・ディスク上の <B>/usr/afs/etc/CellServDB</B> ファイルとは同一でないことに注意してください。サーバー・プロセスは決して外部セルに接続する必要がないため、サーバー・バージョンはサーバー・マシンのホーム・セル内のデータベース・サーバー・マシンのみをリストします。セルのデータベース・サーバー・マシンに変更が加えられた場合は、常にセル内のすべてのマシン上の両方のタイプの <B>CellServDB</B> ファイルを更新することが重要です。<B>CellServDB</B> ファイルのサーバー・バージョンの保守についての詳細は、
<A HREF="auagd008.htm#HDRWQ153">サーバー CellServDB ファイルの保守</A>を参照してください。
</TD></TR></TABLE>
<A NAME="IDX7410"></A>
<A NAME="IDX7411"></A>
<A NAME="IDX7412"></A>
<A NAME="IDX7413"></A>
<A NAME="IDX7414"></A>
<P><H3><A NAME="Header_454" HREF="auagd002.htm#ToC_454">/usr/vice/etc/CellServDB ファイルの表示方法</A></H3>
<OL TYPE=1>
<LI>テキスト・エディターまたは <B>cat</B> コマンドを使用して、
<B>/usr/vice/etc/CellServDB</B> ファイルの内容を表示します。デフォルトでは、ファイルのモード・ビットにより誰でもその内容を読み取ることができます。
<P>
<PRE>   % <B>cat /usr/vice/etc/CellServDB</B>
</PRE>
</LI></OL>
<A NAME="IDX7415"></A>
<A NAME="IDX7416"></A>
<P><H3><A NAME="Header_455" HREF="auagd002.htm#ToC_455">カーネル・メモリー内のデータベース・サーバー・マシンのリストを表示する</A></H3>
<OL TYPE=1>
<LI><B>fs listcells</B> コマンドを発行します。
<P>
<PRE>   % <B>fs listcells [&amp;]</B>
</PRE>
<P>
<P>ここで、
<B>listc</B> は、<B>listcells</B> の受け入れ可能な省略形です。
<P>
<P>シェルのプロンプトが即時に戻されるように、アンパーサンド (<B>&amp;</B>) を入れます。この記号はコマンドがバックグラウンドで実行されるようにします。カーネルがデータベース・サーバー・マシンの IP アドレスのみを保管し、
<B>fs</B> コマンド解釈プログラムがセルのネーム・レゾリューション・サービス
(ドメイン・ネーム・サービスまたはローカル・ホスト・テーブルなど)
を使用してその IP アドレスをホスト名に変換するため、完全な出力を生成するにはある程度時間がかかります。このコマンドは、<B>Ctrl-c</B> などの割り込みシグナルを発行して、いつでも停止させることができます。
<P>
<P>出力は、各セルに対して 1 つの行を含み、形式は次のとおりです。
<P>
<PRE>   Cell <VAR>cell_name</VAR> on hosts <VAR>list_of_hostnames</VAR>.
</PRE>
<P>
<P>ネーム・サービスは、ホスト名を大文字で戻すことがあります。ネーム・サービスが名前を全く解決できない場合は、その名前の IP アドレスを戻します。次の例は、3 つの可能性すべてを示します。
<P>
<PRE>   % <B>fs listcells</B>
      .
      .
   Cell example.com on hosts db1.example.com db2.example.com db3.example.com
   Cell example.org on hosts SERVERA.EXAMPLE.ORG SERVERB.EXAMPLE.ORG
			    SERVERC.EXAMPLE.ORG
   Cell ghi.org on hosts 191.255.64.111 191.255.64.112
      .
      .
</PRE>
</LI></OL>
<A NAME="IDX7417"></A>
<A NAME="IDX7418"></A>
<A NAME="IDX7419"></A>
<A NAME="IDX7420"></A>
<A NAME="IDX7421"></A>
<A NAME="IDX7422"></A>
<A NAME="IDX7423"></A>
<A NAME="IDX7424"></A>
<A NAME="IDX7425"></A>
<A NAME="IDX7426"></A>
<A NAME="IDX7427"></A>
<P><H3><A NAME="Header_456" HREF="auagd002.htm#ToC_456">カーネル・メモリー内のデータベース・サーバー・マシンのリストを変更する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI>クライアント・マシンのソースとして <B>CellServDB</B> ファイルの中央コピーを使用する場合は、そのファイルのディレクトリーの ACL が <B>l</B> (<B>ルックアップ</B>)、
<B>r</B> (<B>読み取り</B>)、および <B>w</B> (<B>書き込み</B>) 許可を付与するかどうかを検査してください。通常のディレクトリーは、<B>/afs/</B><VAR>cell_name</VAR><B>/common/etc</B> です。必要に応じて、<B>fs listacl</B> コマンドを発行します。これについては、
<A HREF="auagd020.htm#HDRWQ788">ACL の表示</A> で詳しく説明しています。
<P>
<PRE>   # <B>fs listacl</B> [&lt;<VAR>dir/file path</VAR>>]
</PRE>
<A NAME="IDX7428"></A>
<A NAME="IDX7429"></A>
</LI><LI><A NAME="LINEWCELL"></A><B>fs newcell</B> コマンドを発行して、セルの項目をカーネル・メモリー内に追加または変更して入れます。各セルごとにコマンドを繰り返します。
<P>
<TABLE><TR><TD ALIGN="LEFT" VALIGN="TOP"><B>注:</B></TD><TD ALIGN="LEFT" VALIGN="TOP">このコマンドを使用してカーネル・メモリー内にあるセルの項目を完全に削除することはできません。まれに指定したセルへのアクセスを緊急に阻止する場合は、
<B>CellServDB</B> ファイルを編集してマシンをリブートする必要があります。
</TD></TR></TABLE>
<P>
<PRE>   # <B>fs newcell</B> &lt;<VAR>cell name</VAR>> &lt;<VAR>primary servers</VAR>><SUP>+</SUP> \
                [<B>-linkedcell</B> &lt;<VAR>linked cell name</VAR>>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>n
</B><DD>は、<B>newcell</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>cell name</VAR>
</B><DD>データベース・サーバー・マシンの新規リストを記録するセルの完全なインターネット・ドメイン名を指定します。
<P><DT><B><VAR>primary servers</VAR>
</B><DD>セルの各データベース・サーバー・マシンの完全修飾ホスト名または IP アドレスを、小数点付き 10 進数の形式で指定します。指定したリストが既存のリストを完全に置換します。
<P><DT><B>-linkedcell
</B><DD>AFS セルの完全インターネット・ドメイン名を指定して、
DFS ファイル・セットを配置する目的で DCE セルにリンクします。マシンの AFS ユーザーが、
AFS/DFS 移行ツールキット・プロトコル変換プログラムを使用して DFS にアクセスする場合は、この引き数を使用することができます。説明については、<I>AFS/DFS Migration Toolkit Administration Guide and Reference</I> を参照してください。
</DL>
</LI><LI>以下に示す 3 つの方法のうち 1 つを使用して、セルの項目を <B>/usr/vice/etc/CellServDB</B> ファイルに追加または編集してファイルに入れます。いずれの方法を使用する場合でも、
<A HREF="#HDRWQ554">CellServDB ファイルの形式</A>に記載されているフォーマット要件に必ず従ってください。
<UL>
<LI><B>CellServDB</B> ファイルの中央ソース・バージョンを保持し、<B>パッケージ</B>・プログラムを使用する場合は、まず最初にテキスト・エディターを使用してそのファイルの中央コピーを変更します。その後で、<B>package</B> コマンドを発行して、ファイルの内容をローカル・マシンに転送します。説明については、<A HREF="auagd016.htm#HDRWQ601">パッケージ・プログラムの実行</A>を参照してください。
<P>
<PRE>   # <B>/etc/package -v -c</B> &lt;<VAR>name of package file</VAR>>
</PRE>
</LI><LI><B>CellServDB</B> ファイルの中央ソースを保持し、<B>パッケージ</B>・プログラムを使用する場合は、まず最初にテキスト・エディターを使用してそのファイルの中央コピーを変更します。その後で、<B>cp</B> コマンドを使用して、そのファイルをローカル <B>/usr/vice/etc/CellServDB</B> ファイルにコピーします。
</LI><LI>中央ソース <B>CellServDB</B> ファイルを使用しない場合は、ローカル・マシンの <B>/usr/vice/etc/CellServDB</B> ファイルを直接編集します。
</LI></UL>
</LI></OL>
<HR><H2><A NAME="HDRWQ556" HREF="auagd002.htm#ToC_457">クライアントが Setuid プログラムを実行できるかどうかを決定する</A></H2>
<A NAME="IDX7430"></A>
<A NAME="IDX7431"></A>
<A NAME="IDX7432"></A>
<P><I>setuid プログラム</I> は、バイナリー・ファイルにおいて UNIX の setuid モード・ビットがオンになっているプログラムです。setuid プログラムの実行中は、そのプログラムを初期化したユーザーがそのバイナリー・ファイルの所有者のローカル一致 (UNIX UID) を取得します。したがって、所有者がローカル・ファイル・システム内で持っていた許可を付与されます。たいていの場合、発行者が取得する一致 (しばしば <I>有効 UID</I> と呼ばれます) は、ローカル・スーパーユーザーの <B>root</B> です。
<P>AFS は、有効 UID を認識しません。
setuid プログラムが AFS ファイルおよびディレクトリーにアクセスする場合は、setuid プログラムの所有者ではなく、そのプログラムを初期化した AFS ユーザーの現行の AFS 一致を使用してアクセスします。それにもかかわらず、setuid プログラムを AFS 内に保管して、
1 つ以上のクライアント・マシンが使用できるようにすることは有用です。AFS では、クライアント・マシンの管理者が、ローカル・キャッシュ・マネージャーに setuid プログラムの実行を許可させるかどうかを決定することができます。
<P>デフォルトでは、キャッシュ・マネージャーは、所属するセルのホーム・セル内のすべてのプログラムが setuid 許可で実行されることを許可しますが、外部セルのプログラムからの setuid 許可を拒否します。あるプログラムは、ファイルが常駐するボリュームが存在するファイル・サーバー・マシンと同じセル内に所属します。このことは、ファイル・サーバー・マシンの <B>/usr/afs/etc/ThisCell</B> ファイルに指定されています。キャッシュ・マネージャーは、<B>/usr/vice/etc/ThisCell</B> ファイルを初期化の際に読み込むことによって、それ自身が所属するホーム・セルを判別します。
<P>ローカル・マシンに関するセルの setuid 状況を変更するには、ローカル・スーパーユーザー <B>root</B> になり、
<B>fs setcell</B> コマンドを発行します。セルの現行の setuid 状況を判別するには、
<B>fs getcellstatus</B> コマンドを使用します。
<P><B>fs setcell</B> コマンドを発行する場合は、カーネル・メモリー内に記録されているセルの setuid 状況を直接変更します。したがって、マシンをリブートする必要はありません。しかしながら、マシンの AFS 初期設定ファイルに適切な
<B>fs setcell</B> コマンドを追加しない場合は、デフォルトでない設定はマシンが次にリブートされるまで持続しません。
<P><B>system:administrators</B> グループのメンバーのみが、
AFS ファイルまたはディレクトリーに対して setuid モード・ビットをオンにすることができます。
setuid のモード・ビットがオンになると、UNIX の <B>ls -l</B> コマンドによって第三者のモード・ビットが <B>x</B> の代わりに <B>s</B> として表示されます。ただし、AFS フ ァイルまたはディレクトリーの場合は、ファイルが常駐するセルで setuid アクセス権が使用可能な場合にのみ、<B>s</B> が表示されます。
<A NAME="IDX7433"></A>
<A NAME="IDX7434"></A>
<P><H3><A NAME="Header_458" HREF="auagd002.htm#ToC_458">セルの setuid 状況を判別する方法</A></H3>
<OL TYPE=1>
<LI><B>fs getcellstatus</B> コマンドを発行して、対象とする各セルの setuid 状況を検査します。
<P>
<PRE>   % <B>fs getcellstatus</B> &lt;<VAR>cell name</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>getce</B>
</B><DD>は、<B>getcellstatus</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>cell name</VAR>
</B><DD>その setuid 状況を報告する各セルを指定します。完全なインターネット・ドメイン名、またはローカル <B>/usr/vice/etc/CellServDB</B> ファイルにリストされた他のセルと区別するドメイン名の短縮フォームです。
</DL>
</LI></OL>
<P>出力には、以下に示す各セルの setuid 状況が報告されます。
<UL>
<LI>ストリング <TT>no setuid allowed</TT> は、キャッシュ・マネージャーがそのセル内のプログラムが setuid 許可を使用して実行されることを許可しないことを示します。
</LI><LI><TT>setuid allowed</TT> は、キャッシュ・マネージャーがそのセル内のプログラムが setuid 許可を使用して実行されることを許可することを示します。
</LI></UL>
<A NAME="IDX7435"></A>
<A NAME="IDX7436"></A>
<P><H3><A NAME="Header_459" HREF="auagd002.htm#ToC_459">セルの setuid 状況を変更する方法</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>fs setcell</B> コマンドを発行して、セルの setuid 状況を変更します。
<P>
<PRE>   # <B>fs setcell</B> &lt;<VAR>cell name</VAR>><SUP>+</SUP> [<B>-suid</B>] [<B>-nosuid</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>setce</B>
</B><DD>は、<B>setcell</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>cell name</VAR>
</B><DD><B>-suid</B> または <B>-nosuid</B> フラグで指定した状況に setuid 状況を変更する各セルを指定します。完全なインターネット・ドメイン名、またはローカル <B>/usr/vice/etc/CellServDB</B> ファイルにリストされた他のセルと区別するドメイン名の短縮フォームです。
<P><DT><B><B>-suid</B>
</B><DD>指定する各セルのプログラムを、setuid 許可を使用して実行できるようにします。各セルに対して、このフラグまたは <B>-nosuid</B> フラグを指定します。あるいは両方を省略して setuid 許可を使用不可にします。
<P><DT><B><B>-nosuid</B>
</B><DD>指定する各セルのプログラムを、setuid 許可を使用して実行できないようにします。各セルに対して、このフラグまたは <B>-suid</B> フラグを指定します。あるいは両方を省略して setuid 許可を使用不可にします。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ557" HREF="auagd002.htm#ToC_460">ファイル・サーバーのプローブ間隔を設定する</A></H2>
<A NAME="IDX7437"></A>
<A NAME="IDX7438"></A>
<A NAME="IDX7439"></A>
<P>キャッシュ・マネージャーは、定期的にサーバー・マシンにプローブを送信して、サーバー・マシンがアクセス可能かどうかを確認します。キャッシュ・マネージャーは、特に、同じセル内のデータベース・サーバー・マシンおよびキャッシュ・マネージャーがキャッシュしたデータが存在するファイル・サーバーをプローブします。
<P>あるサーバー・プロセスがプローブに対して応答しない場合は、クライアント・マシンはそのサーバー・プロセスがアクセス不能であると想定します。デフォルトでは、プローブの間隔は 3 分間であるため、あるサーバー・プロセスがいったんアクセス不能になってから再びアクセス可能になり、そのことをクライアントが認識するまでには 3 分間かかります。
<P>プローブ間隔を調整するには、ローカル・スーパーユーザー <B>root</B> としてログインしているときに、
<B>fs checkservers</B> コマンドに <B>-interval</B> 引き数を指定します。新しい間隔の設定は、そのコマンドを再び発行するか、マシンをリブートするまで持続し、その後はデフォルトの設定に戻ります。デフォルト以外の設定をリブート以降も持続させるためには、マシンの AFS 初期設定ファイルに適切な <B>fs checkservers</B> コマンドを組み込みます。
<P><H3><A NAME="Header_461" HREF="auagd002.htm#ToC_461">クライアントのファイル・サーバー・プローブ間隔を設定する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>-interval</B> 引き数を指定した <B>fs checkservers</B> コマンドを発行します。
<A NAME="IDX7440"></A>
<A NAME="IDX7441"></A>
<P>
<P>
<PRE>   # <B>fs checkservers -interval</B> &lt;<VAR>seconds between probes</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>checks</B>
</B><DD>は、<B>checkservers</B> の受け入れ可能な省略形です。
<P><DT><B>-interval
</B><DD>プローブ間の秒数を指定します。ゼロより大きい整数値を指定します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ558" HREF="auagd002.htm#ToC_462">クライアント・マシンのセル・メンバーシップを設定する</A></H2>
<A NAME="IDX7442"></A>
<A NAME="IDX7443"></A>
<A NAME="IDX7444"></A>
<A NAME="IDX7445"></A>
<A NAME="IDX7446"></A>
<A NAME="IDX7447"></A>
<P>各クライアント・マシンは特定のセルに所属し、その内容は各クライアント・マシンのローカル・ディスク上の <B>/usr/vice/etc/ThisCell</B> に指定されています。マシンのセル・メンバーシップは、そのマシンにユーザーにとって重要な 3 つのデフォルトを決定します。
<UL>
<LI>マシンのユーザーが、<B>login</B> プログラムを使用するとき、または <B>klog</B> コマンドを発行するときに、トークン (認証) を取得するセル。これには、2 つの効果があります。
<UL>
<LI><B>klog</B> プログラムおよび AFS 仕様に変更されたログイン・ユーティリティーは、
<B>ThisCell</B> ファイルで指定されているセル内の認証サーバーに接続します。
</LI><LI><B>klog</B> プログラムおよび AFS 仕様に変更されたログイン・ユーティリティーは、
<B>ThisCell</B> ファイルの内容とユーザーが指定するパスワードを結合して、暗号化鍵を生成します。認証データベース内のユーザー項目には、パスワードとセル名の組み合わせによって生成された暗号化鍵が含まれます。
<B>ThisCell</B> ファイル内のセル名が正しくない場合は、ユーザーが正しいパスワードを指定してもユーザーは識別されません。
</LI></UL>
</LI><LI>キャッシュ・マネージャーがローカル・セル、またはホーム・セルであると判別するセル。キャッシュ・マネージャーは、所属するセルのローカル・セル内のプログラムが setuid 許可で実行されることを許可しますが、外部セルのプログラムには setuid 許可を許可しません。詳細な説明については、
<A HREF="#HDRWQ556">クライアントが Setuid プログラムを実行できるかどうかを決定する</A>を参照してください。
</LI><LI>同じマシン上で実行されている AFS コマンド解釈プログラムが接続するデフォルトのデータベース・サーバー・マシン。
</LI></UL>
<P><H3><A NAME="Header_463" HREF="auagd002.htm#ToC_463">クライアント・マシンのセル・メンバーシップを表示する方法</A></H3>
<OL TYPE=1>
<LI>テキスト・エディターまたは <B>cat</B> コマンドを使用して、
<B>/usr/vice/etc/ThisCell</B> ファイルの内容を表示します。
<P>
<PRE>   % <B>cat /usr/vice/etc/ThisCell</B>
</PRE>
</LI></OL>
<P><H3><A NAME="Header_464" HREF="auagd002.htm#ToC_464">クライアント・マシンのセル・メンバーシップを設定する方法</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI>テキスト・エディターを使用して、<B>/usr/vice/etc/ThisCell</B> ファイル内のセル名を置換します。
</LI><LI><B>(オプション)</B> マシンをリブートして、キャッシュ・マネージャーが即時に新しいセル名を使用できるようにします。適切なコマンドはマシンのシステム・タイプによって異なります。
<B> klog</B> プログラム、AFS 仕様に変更されたログイン・ユーティリティー、および AFS コマンド解釈プログラムは、次に起動されるときに新しいセル名を使用します。リブートする必要はありません。
<P>
<PRE>   # <B>sync</B>

   # <B>shutdown</B>
</PRE>
</LI></OL>
<HR><H2><A NAME="HDRWQ559" HREF="auagd002.htm#ToC_465">キャッシュ・データの更新を強制する</A></H2>
<A NAME="IDX7448"></A>
<A NAME="IDX7449"></A>
<A NAME="IDX7450"></A>
<A NAME="IDX7451"></A>
<A NAME="IDX7452"></A>
<A NAME="IDX7453"></A>
<A NAME="IDX7454"></A>
<A NAME="IDX7455"></A>
<P>通常、AFS のコールバック機構は、キャッシュ・マネージャーがマシン上で実行されているアプリケーション・プログラムに対して、ファイルまたはディレクトリーの最新のバージョンを提供することを保証します。ただし、キャッシュ・マネージャーにキャッシュされたデータを廃棄させて、アプリケーション・プログラムが次にデータを要求したときに、キャッシュ・マネージャーがファイル・サーバーで使用可能な最新のバージョンをフェッチするように強制することもできます。
<P>一度にフラッシュされるファイル・システムの要素数を制御することができます。
<UL>
<LI>特定のファイルまたはディレクトリーをフラッシュする場合は、
<B>fs flush</B> コマンドを使用します。このコマンドは、キャッシュ・マネージャーが特定のファイルまたはディレクトリーからキャッシュしたデータおよび状況情報を廃棄するように強制します。このコマンドは、アプリケーション・プログラムのバッファーの情報、またはローカルで変更された情報は廃棄しません (キャッシュ内での変更であり、まだファイル・サーバーで永続的に保管されていないもの)。ただし、アプリケーションが次にその廃棄した要素のデータまたは状況情報を要求した場合は、キャッシュ・マネージャーはファイル・サーバーに接続してそれらのデータまたは情報を取得する必要があります。
</LI><LI>特定のボリュームから、そこにキャッシュされていた内容をすべてフラッシュするには、<B>fs flushvolume</B> コマンドを使用します。このコマンドは、<B>fs flush</B> と同じように機能しますが、以下の 2 つの点で異なります。
<UL>
<LI>キャッシュ・マネージャーは、指定したファイルまたはディレクトリーのボリュームと同じボリュームに含まれていたキャッシュ内のすべての要素のデータを廃棄します。
</LI><LI>キャッシュ・マネージャーは、データのみを廃棄し、状況情報は廃棄しません。この差は、実際には小さな影響ですが、同じ要素に対してコマンドを使用したときに、<B>ls</B> コマンドの出力とは異なる場合があります。
</LI></UL>
</LI></UL>
<P>コールバック機構の他に、キャッシュ・マネージャーには、ボリュームの位置の変更など、他の種類の変更を追跡する機構を備えています。ボリュームが移動して、キャッシュ・マネージャーがそのボリュームのどのデータにも長期間アクセスしていない場合は、キャッシュ・マネージャーのボリューム・ロケーション・レコードが間違っていることがあります。これを再同期するには、
<B>fs checkvolumes</B> コマンドを使用します。このコマンドを発行すると、キャッシュ・マネージャーは、ボリューム名、ID 名、およびロケーション間のマッピング・テーブルを新規に作成します。このことによって、キャッシュ・マネージャーは新規に再配置およびリネームしたボリュームを参照し、それらのボリュームのデータを提供します。
<P>また、マウント・ポイントに関する情報がキャッシュ内で壊されてしまうことも起こり得ます。マウント・ポイントが破壊されると、<B>fs lsmount</B> コマンドの出力が誤っている、マウント・ポイントにディレクトリーを変更しようとしたり、マウント・ポイントの内容をリストしようとして失敗する、などの症状がでます。このような場合、<B>fs flushmount</B> コマンドを使用して、破壊されたマウント・ポイントを廃棄します。キャッシュ・マネージャーは、この次にパス名にマウント・ポイントを見付けたときは、それを再フェッチしなければなりません。キャッシュ・マネージャーはキャッシュされたマウント・ポイントを定期的に更新しますが、キャッシュされたマウント・ポイントをそれ以外の方法で即時に破棄するには、マシンをリブートしてキャッシュ・マネージャーを再初期化するしかありません。
<A NAME="IDX7456"></A>
<A NAME="IDX7457"></A>
<P><H3><A NAME="Header_466" HREF="auagd002.htm#ToC_466">特定のファイルまたはディレクトリーをフラッシュする方法</A></H3>
<OL TYPE=1>
<LI><B>fs flush</B> コマンドを発行します。
<P>
<PRE>   % <B>fs flush</B> [&lt;<VAR>dir/file path</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>flush</B>
</B><DD>完全な形式でタイプする必要があります。
<P><DT><B><VAR>dir/file path</VAR>
</B><DD>キャッシュからフラッシュする各ファイルまたはディレクトリー構造を指定します。現行作業ディレクトリーをフラッシュする場合はこの引き数を省略します。ディレクトリー構造をフラッシュしても、そのディレクトリー構造からキャッシュされたファイルまたはサブディレクトリーのすべてはフラッシュされません。
</DL>
</LI></OL>
<A NAME="IDX7458"></A>
<A NAME="IDX7459"></A>
<P><H3><A NAME="Header_467" HREF="auagd002.htm#ToC_467">ボリュームからすべてのデータをフラッシュする方法</A></H3>
<OL TYPE=1>
<LI><B>fs flushvolume</B> コマンドを発行します。
<P>
<PRE>  % <B>fs flushvolume</B> [&lt;<VAR>dir/file path</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>flushv</B>
</B><DD>は、<B>flushvolume</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>dir/file path</VAR>
</B><DD>キャッシュからフラッシュする各ボリュームに含まれるファイルまたはディレクトリーを指定します。キャッシュ・マネージャーは、同じボリュームからフェッチした、キャッシュ内のすべての内容をフラッシュします。現行作業ディレクトリーを含むボリュームからフェッチしたすべてのキャッシュ・データをフラッシュする場合は、この引き数を省略します。
</DL>
</LI></OL>
<A NAME="IDX7460"></A>
<A NAME="IDX7461"></A>
<P><H3><A NAME="Header_468" HREF="auagd002.htm#ToC_468">キャッシュ・マネージャーがその他のボリュームの変更を認識する</A></H3>
<OL TYPE=1>
<LI><B>fs checkvolumes</B> コマンドを発行します。
<P>
<PRE>   % <B>fs checkvolumes</B>
</PRE>
<P>
<P>ここで、<B>checkv</B> は、<B>checkvolumes</B> の受け入れ可能な省略形です。
</LI></OL>
<P>次のコマンドは、コマンドが正常に終了したことを確認します。
<PRE>   All volumeID/name mappings checked.
</PRE>
<A NAME="IDX7462"></A>
<A NAME="IDX7463"></A>
<P><H3><A NAME="HDRWQ560" HREF="auagd002.htm#ToC_469">1 つ以上のマウント・ポイントをフラッシュする</A></H3>
<OL TYPE=1>
<LI><B>fs flushmount</B> コマンドを発行する。
<P>
<PRE>   % <B>fs flush</B> [&lt;<VAR>dir/file path</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B><B>flushm</B>
</B><DD><B>flushmount</B> の最も短い受け入れ可能な省略形です。
<P><DT><B><VAR>dir/file path</VAR>
</B><DD>キャッシュからフラッシュする各マウント・ポイントを指定します。現行作業ディレクトリーをフラッシュする場合はこの引き数を省略します。関連付けられているボリュームからキャッシュされたファイルまたはサブディレクトリーは影響を受けません。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ561" HREF="auagd002.htm#ToC_470">サーバーのプリファレンス・ランクの保守</A></H2>
<A NAME="IDX7464"></A>
<A NAME="IDX7465"></A>
<A NAME="IDX7466"></A>
<A NAME="IDX7467"></A>
<A NAME="IDX7468"></A>
<A NAME="IDX7469"></A>
<P>この章の概説で説明したように、AFS はクライアント・サイドのデータ・キャッシングを使用し、コールバックを行って、セルのネットワーク通信量を削減します。また、キャッシュ・マネージャーは、ローカル・マシンに対するネットワークの接近性に基づいてサーバー・マシンに <I>プリファレンス・ランク</I> を割り当てることによって、ネットワークの使用をできるだけ効率的にしようとします。ランクは、可能な場合は、他のネットワークではなくそのランクのサブネットワークやネットワーク上にあるサーバー・マシンから、キャッシュ・マネージャーが情報を取り出すようにします。クライアントおよびサーバー・マシン間をデータが行き来するネットワーク距離を削減することによって、ネットワーク通信量が減少し、キャッシュ・マネージャーのアプリケーションへのデータ・デリバリー速度が増加します。
<P>キャッシュ・マネージャーは、2 つの別々のプリファレンス・ランクの組を、カーネル・メモリーに保管します。ランクの最初の組は、ボリューム・ロケーション (VL) サーバー・プロセスを実行するマシンに適用されるので、
<I>VL サーバー・マシン</I> と呼ばれます。ランクの 2 番目の組は、ファイル・サーバー・プロセスを実行するマシンに適用されるので、
<I>ファイル・サーバー・マシン</I> と呼ばれます。この機能グループでは、キャッシュ・マネージャーがデフォルトのランクを設定する方法、<B>fs setserverprefs</B> コマンドを使用してデフォルトを変更または新規ランクを設定する方法、および<B>fs getserverprefs</B> コマンドを使用してランクの現在の組を表示する方法について説明します。
<P><H3><A NAME="Header_471" HREF="auagd002.htm#ToC_471">キャッシュ・マネージャーがデフォルトのランクを設定する方法</A></H3>
<P><B>afsd</B> プログラムは、キャッシュ・マネージャーを初期設定するときに、ローカルの <B>/usr/vice/etc/CellServDB</B> ファイルにリストされた各 VL サーバー・マシンに対して、
10,000 のプリファレンス・ランクを割り当てます。それから、このプログラムは、
0 (ゼロ) から 126 までの範囲から無作為に選択した 1 つの整数を追加して、ランクを無作為化します。この方法は、1 つのセル内の複数のマシンに同じランクを割り当てるのは避けられますが、異なるセルのマシンに同じランクを設定する可能性があります。これは、使用上の問題にはなりません。キャッシュ・マネージャーでは、1 度に 1 つのセル内のデータベース・サーバー・マシンのランクが比較されるからです。
AFS は、マルチホーム・データベース・サーバー・マシンの使用をサポートしますが、キャッシュ・マネージャーは、ローカルの <B>/usr/vice/etc/CellServDB</B> ファイルに各データベース・サー・マシンごとにリストされた単一のアドレスだけを使用します。Ubik だけが、マルチホーム・データベース・サーバー・マシンのマルチ・インターフェースを利用することができます。
<P>キャッシュ・マネージャーは、VL サーバーからそのサーバーの VLDB レコードを入手するとき、マシンに常駐するボリュームに初めてアクセスするとき、プリファレンス・ランクをファイル・サーバーに割り当てます。マルチホームのマシンの場合、キャッシュ・マネージャーは、各インターフェース (各マシン用に VLDB が保管できるインターフェースの最大数まで。これについては、<I>AFS Release Notes</I>で指定されています) ごとに別のランクを割り当てます。キャッシュ・マネージャーは、インターフェースの IP アドレスとローカル・マシンのアドレスを比較し、以下のアルゴリズムを適用します。
<UL>
<LI>ローカル・マシンがファイル・サーバー・マシンである場合は、各インターフェースの基準ランクは 5,000 です。
</LI><LI>ファイル・サーバー・マシン・インターフェースがローカル・マシンと同じサブネットワーク上にある場合は、その基準ランクは 20,000 です。
</LI><LI>ファイル・サーバー・マシン・インターフェースがローカル・マシンと同じサブネットワーク上にあるか、またはローカル・マシンとのポイントツーポイント・リンクの最も遠い終端にある場合は、その基準ランクは 30,000 です。
</LI><LI>ファイル・サーバー・マシン・インターフェースがローカル・マシンと異なるネットワーク上にある場合、またはキャッシュ・マネージャーがそのインターフェースに関するネットワーク情報を入手できない場合は、その基準ランクは 40,000 です。
</LI></UL>
<P>クライアント・マシンのインターフェースが 1 つだけの場合、キャッシュ・マネージャーはこれをサーバー・インターフェースの IP アドレスと比較し、アルゴリズムに従ってランクを設定します。クライアント・マシンがマルチホームであれば、キャッシュ・マネージャーは各ローカル・インターフェースのアドレスをサーバー・インターフェースと比較し、すべてのクライアント・インターフェースと比較して最下位のランクをサーバー・インターフェースに割り当てます。
<P>ファイル・サーバー・マシン・インターフェースに基準ランクを割り当てた後、キャッシュ・マネージャーは、0 (ゼロ) から 15 までの範囲から無作為に選択した数字を、この値に追加します。たとえば、ローカル・マシンと同じサブネットワークにあるファイル・サーバー・マシン・インターフェースが、基準ランク 20,000 を受け取ったとしても、実際のランクは、20,000 と 20,015 の間の整数として記録されます。このプロセスにより、正確に同じランクを持つインターフェースの数は減少します。VL サーバー・マシンのランクの場合、外部セルからのファイル・サーバー・マシン・インターフェースは、ローカル・セルのインターフェースと同じランクを持つことができますが、これは問題になることがありません。特定のボリュームが存在するインターフェースの相対的ランクだけが関係があります。
AFS は、1 度に 1 つのセルにおいてのみ、ボリュームの記憶域をサポートします。
<P><H3><A NAME="Header_472" HREF="auagd002.htm#ToC_472">キャッシュ・マネージャーによるプリファレンス・ランクの使用方法</A></H3>
<P>各プリファレンス・ランクは、インターフェースの IP アドレスと 1 から 65,534 までの範囲の整数の対になっています。低いランク (小さい値の数字) は、プリファレンスが強いことを示します。いったん設定すると、ランクは、マシンをリブートするまで、または<B>fs setserverprefs</B> コマンドを使用して変更するまで、継続します。
<P>キャッシュ・マネージャーは、セルからボリューム・ロケーション情報をフェッチする必要があるときに、VL サーバー・マシンのランクを使用します。キャッシュ・マネージャーは、セルの VL サーバー・マシンのランクを比較して、最も高いランク (最も小さい整数) のマシン上の VL サーバー・プロセスに接続しようとします。その VL サーバーに到達できない場合は、その次に高いランクのVL サーバーへの接続を試行する、などというようにします。セルのすべてのマシンにアクセスできない場合は、キャッシュ・マネージャーは、セルからデータをフェッチすることができません。
<P>同様に、ボリュームからデータをフェッチしなければならない場合、キャッシュ・マネージャーは、ボリュームが存在するマシンのインターフェースのランクを比較し、最も高いランクのインターフェースへの接続を試行します。そのインターフェースを経由する<B>ファイル・サーバー</B>・プロセスに到達できない場合は、その次に高いランクの整数のインターフェースへの接続を試行する、などというようにします。ボリュームが存在するマシンのインターフェースのいずれにも接続できない場合、キャッシュ・マネージャーは、ボリュームからデータをフェッチすることができません。
<P><H3><A NAME="Header_473" HREF="auagd002.htm#ToC_473">プリファレンス・ランクの表示および設定</A></H3>
<P>キャッシュ・マネージャーが使用している、ファイル・サーバー・マシンのランクを表示するには、
<B>fs getserverprefs</B> コマンドを使用します。または、
<B>-vlservers</B> フラグを組み込み、VL サーバー・マシンのランクを表示します。デフォルトでは、標準出力ストリーム (stdout) 上に出力が表示されますが、
<B>-file</B> 引き数を組み込むことにより、ランクをファイルに書き込むことができます。
<P>キャッシュ・マネージャーは、カーネルのランク・リストに、ホスト名ではなく IP アドレスを保管します。ただし、デフォルトでは、セルの名前のサービス (ドメイン名サーバーなど) またはローカル・ホスト表のいずれかを参照する変換ルーチンを呼び出した後、出力はインターフェースを識別します。この場合は、IP アドレスが表示されます。これは、変換しようとして失敗したからです。変換ステップをう回して、ホスト名ではなく IP アドレスを表示するには、
<B>-numeric</B> フラグを組み込みます。これにより、出力速度をかなり上げることができます。
<P><B>fs setserverprefs</B> コマンドを使用して、既存のプリファレンス・ランクをリセットしたり、キャッシュ・マネージャーがランクを設定していないファイル・サーバー・インターフェースや VL サーバー・マシンにランクの初期値を設定したりできます。設定したランクは、マシンがリブートするまで、または <B>fs setserverprefs</B> コマンドを再発行するまで、継続します。ランクをリブート以降も持続させるためには、マシンの AFS 初期設定ファイルに適切な <B>fs setserverprefs</B> コマンドを組み込みます。
<P>デフォルトのランクの場合、キャッシュ・マネージャーは、無作為に選択した整数を、割り当てた各ランク範囲に加算します。ファイル・サーバー・マシン・インターフェースの場合、無作為化する数字は、0 (ゼロ) から 15 までの範囲です。VL サーバー・マシンの場合は、0 (ゼロ) から 126 までの範囲です。たとえば、ファイル・サーバー・マシン・インターフェースに 15,000 のランクを割り当てた場合、キャッシュ・マネージャーは、
15,000 から 15,015 までの間の整数を保管します。
<P>VL サーバー・マシンのランクを割り当てるには、
<B>fs setserverprefs</B> コマンドに <B>-vlserver</B> 引き数を指定した後、ランクをリストします。
<P>ファイル・サーバー・マシンのランクを割り当てるには、次の 3 つの可能な方法の 1 つまたは複数を使用します。
<OL TYPE=1>
<LI>コマンド行において、<B>-servers</B> 引き数の後にこれらのランクをリストする。
</LI><LI>ファイルにランクを記録し、そのファイルを <B>-file</B> で指定する。
<B>fs getserverprefs</B> コマンドに <B>-file</B> 引き数を組み込むことによって、正しい形式のファイルを簡単に生成することができます。
</LI><LI><B>-stdin</B> フラグを組み込み、標準入力ストリームによってランクを与える。これにより、セルに適したアルゴリズムを使用して、プリファレンスを生成するコマンドまたはスクリプトから、値を直接与えることができます。各対の間、または対の 2 つの部分の間に、1 つまたは複数のスペースを入れて、正しい形式でファイルを生成する必要があります。AFS の配布には、このようなスクリプトは組み込まれていません。したがって、この方法を使用したい場合は、自分でファイルを書き込む必要があります。
</LI></OL>
<P>必要な場合、同じコマンド行において、<B>-servers</B>、<B>-file</B>、および <B>-stdin</B> オプションを任意に組み合わせることができます。これらのオプションを 1 つ以上使用して、同じインターフェースに対するランクを指定した場合、
the <B>-servers</B> 引き数によって割り当てられたランクが優先されます。同じコマンド行に <B>-vlservers</B> 引き数を指定して、VL サーバー・マシンのランクをファイル・サーバー・マシンのランクと同時に指定することもできます。
<P><B>fs</B> コマンド・インタープリターは、ホスト名または IP アドレスを検証しません。したがって、実際には存在しないホスト名やアドレスに対するランクも保管します。キャッシュ・マネージャーは、サーバー・マシンに対する同じ VLDB レコードが同じ不正確な情報を記録するのでなければ、このようなランクを使用しません。
<A NAME="IDX7470"></A>
<A NAME="IDX7471"></A>
<P><H3><A NAME="Header_474" HREF="auagd002.htm#ToC_474">サーバーのプリファレンス・ランクを表示する</A></H3>
<OL TYPE=1>
<LI><B>fs getserverprefs</B> コマンドを発行して、ファイル・サーバー・マシンまたは VL サーバー・マシンに対するキャッシュ・マネージャーのプリファレンス・ランクを表示します。
<P>
<PRE>   % <B>fs getserverprefs</B> [<B>-file</B> &lt;<VAR>output to named file</VAR>>] [<B>-numeric</B>] [<B>-vlservers</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>gp
</B><DD>は、<B>getserverprefs</B> の受け入れ可能な別名です
(<B>gets</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-file
</B><DD>ランクのリストを書き込むファイルのパス名を指定します。この引き数を省略すると、リストが標準出力ストリーム (stdout) に表示されます。
<P><DT><B>-numeric
</B><DD>ランク付けされた各マシン・インターフェースのホスト名ではなく、IP アドレスが表示されます。このフラグを省略すると、アドレスがより長いホスト名に変換されます。
<P><DT><B>-vlservers
</B><DD>ファイル・サーバー・マシンではなく、VL サーバー・マシンのランクを表示します。
</DL>
<P>
<P>次の例では、ファイル・サーバー・マシンのランクを表示します。
<B>-numeric</B> フラグは使用されていないので、IP アドレスの表示は現在、そのアドレスをホスト名に変換できないことを示しています。
<P>
<PRE>   % <B>fs gp</B>
   fs5.example.com         20000
   fs1.example.com         30014
   server1.example.org  40011
   fs3.example.com         20001
   fs4.example.com         30001
   192.12.106.120      40002
   192.12.106.119      40001
      .   .   .   .   .     . .
</PRE>
</LI></OL>
<A NAME="IDX7472"></A>
<A NAME="IDX7473"></A>
<A NAME="IDX7474"></A>
<P><H3><A NAME="Header_475" HREF="auagd002.htm#ToC_475">サーバーのプリファレンス・ランクを設定する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>fs setserverprefs</B> コマンドを発行して、
1 つまたは複数のファイル・サーバー・マシンまたは VL サーバー・マシンに対するキャッシュ・マネージャーのプリファレンス・ランクを設定します。
<P>
<PRE>   # <B>fs setserverprefs</B> [<B>-servers</B> &lt;<VAR>fileserver names and ranks</VAR>><SUP>+</SUP>]  \
                       [<B>-vlservers</B> &lt;<VAR>VL server names and ranks</VAR>><SUP>+</SUP>]  \
                       [<B>-file</B> &lt;<VAR>input from named file</VAR>>] [<B>-stdin</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sp
</B><DD>は、<B>setserverprefs</B> の受け入れ可能な別名です
(<B>sets</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-servers
</B><DD>は、1 つまたは複数のファイル・サーバー・マシンとそのランクの対を指定します。完全に修飾されたホスト名または IP アドレスを、小数点付き 10 進数形式で各インターフェースに指定します。使用可能なランクは、<B>1</B> から <B>65534</B> までの間の整数です。1 つまたは複数のブランクによって、対の各部分、および対と対を区切ります。
<P><DT><B>-vlservers
</B><DD>は、1 つまたは複数の VL サーバー・マシンとそのランクの対を指定します。完全に修飾されたホスト名または IP アドレスを、小数点付き 10 進数形式で各マシンに指定します。使用可能なランクは、<B>1</B> から <B>65534</B> までの間の整数です。
<P><DT><B>-file
</B><DD>は、1 つまたは複数のファイル・サーバー・マシン・インターフェースとそのランクの対を含むファイルのパス名を指定します。ファイル内の別々の行に各組を配置します。インターフェースとランクの形式は、<B>-servers</B> 引き数を指定した場合と同じ形式を使用します。
<P><DT><B>-stdin
</B><DD>ファイル・サーバー・マシン・インターフェースの対およびランクが標準入力ストリーム (stdin) によって提供されていることを示します。対を生成するプログラムまたはスクリプトは、
<B>-servers</B> 引き数の場合と同じように、対を形式設定しなければなりません。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ562" HREF="auagd002.htm#ToC_476">マルチホーム・クライアント・マシンの管理</A></H2>
<A NAME="IDX7475"></A>
<A NAME="IDX7476"></A>
<A NAME="IDX7477"></A>
<A NAME="IDX7478"></A>
<A NAME="IDX7479"></A>
<A NAME="IDX7480"></A>
<P>ファイル・サーバーがマルチホーム・クライアント・マシン (複数のネットワーク・インターフェースおよび IP アドレスを持つマシン) 上のキャッシュ・マネージャーとの通信を開始する場合、ファイル・サーバーはメッセージの送信先のアドレスを選択することができます。選択したインターフェースがアクセス不能であった場合は、送信先のインターフェースが代替のアドレスに自動的に切り替えられます。これにより、
AFS のパフォーマンスが向上します。つまり、あるインターフェースの故障は、ファイル・サーバーとキャッシュ・マネージャー間の通信を中断しません。
<P>ファイル・サーバーは、以下の 2 つのタイプのメッセージを送信する際に、クライアント・インターフェースを選択することができます。
<UL>
<LI>キャッシュ・マネージャーがキャッシュ・ファイルで保持するコールバックを中断するメッセージ
</LI><LI>キャッシュ・マネージャーがまだアクセス可能であり応答していることを確認する <I>ping</I> メッセージ。ファイル・サーバーはこのようなメッセージを数分おきに送信します。
</LI></UL>
<P>(ファイル・サーバーは、キャッシュ・マネージャーの AFS データ要求を埋め込む際にどのクライアント・インターフェースに応答するか選択しません。この場合、ファイル・サーバーは常に、要求を送信したキャッシュ・マネージャーを経由してクライアント・インターフェースに応答します。)
<P>キャッシュ・マネージャーは、クライアント・マシン上の適格なインターフェースを初期設定し、これをカーネル・メモリーに記憶すると、そのリストをコンパイルします。キャッシュ・マネージャーがファイル・サーバーとの間で最初に接続を確立するときには、キャッシュ・マネージャーは、インターフェース・アドレスのリストも一緒に送信します。ファイル・サーバーは、このクライアント・マシンのアドレスを記録し、コールバックを中断するとき、または PING を送信するときにこのリストの最初に記載されているアドレスを使用します。そのインターフェースがアクセス不能である場合は、ファイル・サーバーは、リストに含まれるその他のすべてのインターフェースに同時にメッセージを送信します。最初に応答したインターフェースを使用して、ファイル・サーバーは以降のメッセージを送信します。
<P>キャッシュ・マネージャーがファイル・サーバー用に登録するアドレスを制御するには、クライアント・マシンのローカル・ディスク上の <B>/usr/vice/etc</B> ディレクトリーにある 2 つのファイル
(<B>NetInfo</B> および <B>NetRestrict</B>) にそのアドレスをリストします。<B>NetInfo</B> ファイルがキャッシュ・マネージャーの初期設定時に存在する場合は、キャッシュ・マネージャーは、インターフェースのリストの基本としてその内容を使用します。存在しない場合は、キャッシュ・マネージャーはオペレーティング・システムによって構成されたインターフェースのリストを使用します。その上でキャッシュ・マネージャーは、<B>/usr/vice/etc/NetRestrict</B> ファイルがある場合には、そのリストのアドレスを削除します。キャッシュ・マネージャーは、結果リストをカーネル・メモリーに記録します。
<P>また、<B>fs setclientaddrs</B> コマンドを使用して、クライアント・マシンをリブートせずに、キャッシュ・マネージャーのカーネル・メモリー内に保管されているアドレス・リストを変更することができます。コマンド行で指定するアドレス・リストは、カーネル・メモリー内の現行リストを完全に置換します。ただし、実行した変更は、クライアント・マシンがリブートするときまで持続します。リブート後でも更新リストを持続させるには、そのインターフェースをローカル・ディレクトリー
<B>/usr/vice/etc</B> の <B>NetInfo</B> ファイル (および使用できれば <B>NetRestrict</B> ファイル) にリストします。
(適切な <B>fs setclientaddrs</B> コマンドをマシンの AFS 初期設定スクリプトに配置する場合も有効ですが、上記の方法と比べるとそれ程効果的ではありません。キャッシュ・マネージャーがそのコマンドを読み取るときには、キャッシュ・マネージャーは既にインターフェースのリストをコンパイルしているからです。)
<P>キャッシュ・マネージャーがファイル・サーバー用に現時点で登録しているアドレス・リストを確認するには、
<B>fs getclientaddrs</B> コマンドを使用します。
<P><B>NetInfo</B> または <B>NetRestrict</B> ファイルを変更する場合、あるいは <B>fs getclientaddrs</B> または <B>fs setclientaddrs</B> コマンドを発行するときには、以下の事項を考慮してください。
<UL>
<LI><B>fs setclientaddrs</B> コマンドを発行するときには、アドレスの更新リストはキャッシュ・マネージャーが既に接続を確立したファイル・サーバーへは自動的に伝搬されません。ファイル・サーバーは、キャッシュ・マネージャーが最初に接続を確立したときにファイル・サーバー用に登録したリストを継続して使用します。以前接続したファイル・サーバーが更新リストを使用するように強制するには、それぞれのファイル・サーバー・マシンをリブートするか、クライアント・マシンの <B>NetInfo</B> ファイルまたは <B>NetRestrict</B> ファイル (あるいはその両方) を変更してからそのマシンをリブートする必要があります。
</LI><LI><B>fs</B> コマンド・インタープリターは、
<B>fs setclientaddrs</B> コマンド行で指定する各アドレスが、実際にクライアント・マシン上のオペレーティング・システムによって構成されたものであるかどうかを検査します。そうでない場合は、コマンドは失敗し、指定したアドレスが <TT>Nonexistent  interface</TT> であると指示するエラー・メッセージが戻されます。
</LI><LI>先述のとおり、ファイル・サーバーは、キャッシュ・マネージャーのデータ要求に応答するときには登録されたアドレス・リストを使用しません
(通信自体を開始するときは対照的に)。ファイル・サーバーは常に、キャッシュ・マネージャーが要求を送信したときに使用したインターフェースを使用して応答を送信しようと試みます。応答の試行が失敗した場合は、キャッシュ・マネージャーが登録したアドレス・リストではなく、ファイル・サーバー・マシンのネットワーク・ルーティング構成を使用して、応答を再度送信するための代替ネットワーク経路を選択します。
</LI><LI>キャッシュ・マネージャーは、ファイル・サーバーとの接続を確立するために使用するインターフェースを選択する際には、インターフェース・リストを使用しません。
</LI><LI>指定するファイル・サーバーとキャッシュ・マネージャーが最初に通信した後で、システム管理者が <B>fs setclientaddrs</B> コマンドを発行した場合は、
<B>fs getclientaddrs</B> コマンドが表示するアドレス・リストは、必ずしも指定するファイル・サーバーが使用中のアドレスであるとは限りません。このコマンドは、キャッシュ・マネージャーが今後ファイル・サーバーと接続するときにどのアドレスを登録するかを決定するだけです。
</LI></UL>
<A NAME="IDX7481"></A>
<A NAME="IDX7482"></A>
<A NAME="IDX7483"></A>
<A NAME="IDX7484"></A>
<P><H3><A NAME="Header_477" HREF="auagd002.htm#ToC_477">クライアントの NetInfo ファイルを作成または編集する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI>テキスト・エディターを使用して、<B>/usr/vice/etc/NetInfo</B> ファイルをオープンします。各行に小数点付き 10 進数の IP アドレスを配置します (たとえば、<TT>192.12.107.33</TT>)。1 行目に、各ファイル・サーバーが最初に使用するアドレスを配置します。最初のインターフェースに対する RPC が失敗すると、ファイル・サーバーはリストに含まれるその他のすべてのインターフェースに同時に RPC を送信するため、残りのマシンの順序は重要ではありません。最初に応答したインターフェースを使用して、ファイル・サーバーは PING を送信したり、コールバックを中断する RPC を送信します。
</LI><LI>キャッシュ・マネージャーで更新リストがすぐに使用されるようにするには、マシンをリブートするか、または <B>fs setclientaddrs</B> コマンドを使用して、カーネル・メモリー内に直接同じアドレス・リストを作成します。
</LI></OL>
<A NAME="IDX7485"></A>
<A NAME="IDX7486"></A>
<A NAME="IDX7487"></A>
<A NAME="IDX7488"></A>
<P><H3><A NAME="Header_478" HREF="auagd002.htm#ToC_478">クライアントの NetRestrict ファイルを作成または編集する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI>テキスト・エディターを使用して、<B>/usr/vice/etc/NetRestrict</B> ファイルをオープンします。各量に小数点付き 10 進数の IP アドレスを配置します。アドレスはどのような順序でもかまいません。そのフィールドで可能なすべてのアドレスを表すワイルドカードには、値 <B>255</B> を使用します。たとえば <TT>192.12.105.255</TT> と入力した場合、キャッシュ・マネージャーは、192.12.105 サブネットのいずれのアドレスも登録しません。
</LI><LI>キャッシュ・マネージャーで更新リストがすぐに使用されるようにするには、マシンをリブートするか、または <B>fs setclientaddrs</B> コマンドを使用して、使用禁止アドレスを含まないアドレス・リストを設定します。
</LI></OL>
<A NAME="IDX7489"></A>
<A NAME="IDX7490"></A>
<P><H3><A NAME="Header_479" HREF="auagd002.htm#ToC_479">カーネル・メモリー内のアドレス・リストを表示する</A></H3>
<OL TYPE=1>
<LI><B>fs getclientaddrs</B> コマンドを発行します。
<P>
<PRE>   % <B>fs getclientaddrs</B>
</PRE>
<P>
<P>ここで、<B>gc</B>は <B>getclientaddrs</B> の受け入れ可能な別名です (<B>getcl</B> は受け入れ可能な最も短い省略形です)。
</LI></OL>
<P>出力は、各 IP アドレスを小数点付き 10 進数の形式で別々の行に表示します。
<A NAME="IDX7491"></A>
<A NAME="IDX7492"></A>
<P><H3><A NAME="Header_480" HREF="auagd002.htm#ToC_480">カーネル・メモリー内のアドレス・リストを設定する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>fs setclientaddrs</B> コマンドを発行して、カーネル・メモリー内の現行のアドレス・リストを新規リストで置換します。
<P>
<PRE>   # <B>fs setclientaddrs</B> [<B>-address</B> &lt;<VAR>client network interfaces</VAR>><SUP>+</SUP>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sc
</B><DD>は、<B>setclientaddrs</B> の受け入れ可能な別名です
(<B>setcl</B> は受け入れ可能な最も短い省略形です)。
<P><DT><B>-address
</B><DD>1 つまたは複数の IP アドレスを小数点付き 10 進数の形式で指定します (ホスト名は使用できません)。各アドレスは、1 つ以上のスペースを使用して分離します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ563" HREF="auagd002.htm#ToC_481">警告および状況メッセージの表示を制御する</A></H2>
<A NAME="IDX7493"></A>
<A NAME="IDX7494"></A>
<P>デフォルトでは、キャッシュ・マネージャーは 2 つのタイプの警告および情報メッセージを生成します。
<UL>
<LI>キャッシュ・マネージャー、ユーザー・レベルの状況および警告情報を提供する<I>ユーザー・メッセージ</I>を、ユーザーの画面に送信します。
</LI><LI>キャッシュ・マネージャー、システム・レベルの状況および警告情報を提供する<I>コンソール・メッセージ</I>を、クライアント・マシンに指定されたコンソールに送信します。
</LI></UL>
<P><B>fs messages</B> コマンドを使用して、キャッシュ・マネージャーがどちらかのタイプのメッセージを表示するのか、両方のタイプのメッセージを表示するのか、あるいはどちらのタイプも表示しないのかを制御することができます。メッセージは有用な情報を提供するため、メッセージを完全に使用不可にしないことをお勧めします。
<P>キャッシュ・マネージャーの状況およびパフォーマンスをより積極的に監視する場合は、
<B>afsmonitor</B> プログラムを使用して、広範囲な統計セットを収集することができます
(このセットは、ファイル・サーバーの統計も収集します)。パフォーマンス上に問題がある場合は、
<B>fstrace</B> コマンドの組を使用して、キャッシュ・マネージャー操作の低水準トレースを収集することができます。
AFS サポートおよび開発グループがこのトレースを分析することは、問題の解決に役立ちます。両方のユーティリティーについて確認するには、<A HREF="auagd013.htm#HDRWQ439">AFS パフォーマンスのモニターおよび監査</A>を参照してください。
<A NAME="IDX7495"></A>
<A NAME="IDX7496"></A>
<P><H3><A NAME="Header_482" HREF="auagd002.htm#ToC_482">警告および状況メッセージの表示を制御する方法</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>-show</B> 引き数を指定した <B>fs
messages</B> コマンドを発行して、表示するメッセージのタイプを指定します。
<P>
<PRE>   # <B>fs messages -show</B> &lt;<B>user</B>|<B>console</B>|<B>all</B>|<B>none</B>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>me
</B><DD>は、<B>messages</B> の受け入れ可能な省略形です。
<P><DT><B>-show
</B><DD>表示するメッセージのタイプを指定します。次のいずれかの値を選択します。
<P>
<DL>
<P><DT><B>user
</B><DD>ユーザー・メッセージをユーザーの画面に送信します。
<P><DT><B>console
</B><DD>コンソール・メッセージをコンソールに送信します。
<P><DT><B>all
</B><DD>ユーザー・メッセージをユーザーの画面に、そしてコンソール・メッセージをコンソールへ送信します
(<B>-show</B> 引き数を省略すると、デフォルトになります)。
<P><DT><B>none
</B><DD>メッセージを完全に使用不可にします。
</DL>
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ564" HREF="auagd002.htm#ToC_483">システム・タイプ名の表示および設定</A></H2>
<A NAME="IDX7497"></A>
<A NAME="IDX7498"></A>
<P>キャッシュ・マネージャーは、ローカル・クライアント・マシンのシステム・タイプ名を、カーネル・メモリーに保管します。キャッシュ・マネージャーは、ハードコーディングされた定義からデフォルト値を読み取ります。
<P>キャッシュ・マネージャーでは、システム名を、AFS パス名の <VAR>@sys</VAR> 変数の代わりに使用します。この変数は、ローカル・ディスクから、クライアント・マシンのシステム・タイプのバイナリーを収容する AFS ディレクトリーへの記号リンクを作成するときに便利です。<VAR>@sys</VAR> 変数は、キャッシュ・マネージャーを自動的に適切なディレクトリーへと導くので、異なるシステム・タイプのクライアント・マシンに同じ記号リンクを作成することができます(<A HREF="auagd016.htm#HDRWQ566">パッケージ・プログラムを使用したクライアント・マシンの構成</A>で説明するパッケージ・ユーティリティーを使用して、作成操作を自動化することもできます)。リンクは、マシンを新規システム・タイプにアップグレードした後も有効です。
<P>AFS が割り当てるシステム・タイプ名を使用する場合は、構成は最も簡単です。リストについては、<I>AFS Release Notes</I>を参照してください。
<P>カーネル・メモリーに保管されているシステム名を表示するには、<B>sys</B> または <B>fs sysname</B> コマンドを使用します。名前を変更するには、後者のコマンドの <B>-newsys</B> 引き数を追加します。
<A NAME="IDX7499"></A>
<A NAME="IDX7500"></A>
<A NAME="IDX7501"></A>
<A NAME="IDX7502"></A>
<P><H3><A NAME="Header_484" HREF="auagd002.htm#ToC_484">システム・タイプ名を表示する</A></H3>
<OL TYPE=1>
<LI><B>fs sysname</B> あるいは <B>sys</B> コマンドを発行する。
<P>
<PRE>   % <B>fs sysname</B>

   % <B>sys</B>
</PRE>
</LI></OL>
<P><B>fs sysname</B> コマンドの出力は以下の形式をしています。
<PRE>   Current sysname is '<VAR>system_name</VAR>'
</PRE>
<P><B>sys</B> コマンドは、<VAR>system_name</VAR> 文字列だけを表示し、その他のテキストは表示しません。
<P><H3><A NAME="Header_485" HREF="auagd002.htm#ToC_485">システム・タイプ名を変更する</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>-newsys</B> 引き数を使用して
<B>fs sysname</B> コマンドを発行し、新規システム・タイプ名を指定します。
<P>
<PRE>   # <B>fs sysname</B> &lt;<VAR>new sysname</VAR>>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>sys
</B><DD>は、<B>sysname</B> の受け入れ可能な省略形です。
<P><DT><B><VAR>new sysname</VAR>
</B><DD>新しいシステム・タイプ名を指定します。
</DL>
</LI></OL>
<HR><H2><A NAME="HDRWQ565" HREF="auagd002.htm#ToC_486">非同期書き込みを使用可能にする</A></H2>
<A NAME="IDX7503"></A>
<A NAME="IDX7504"></A>
<A NAME="IDX7505"></A>
<P>デフォルトで、キャッシュ・マネージャーは、アプリケーション・プログラムがファイルをクローズするときに、即時にかつ同期的にファイル・サーバーにすべてのデータを書き込みます。つまり、キャッシュ・マネージャーが実際にすべてのファイルをファイル・サーバーに書き込むまで、
<B>クローズ</B>のシステム呼び出しは戻されません。キャッシュ・マネージャーがファイルを非同期的に書き込むように、キャッシュ・マネージャーを使用可能にすることができます。その場合は、キャッシュ・マネージャーがアプリケーションに制御を戻すときに、ファイル・サーバーへ書き込むために残っているファイルの K バイト の数値を指定します。
<P>非同期書き込みを使用可能にすると、通常アプリケーションの実行が速くなるため、日ごろかなり大きなサイズのファイルを扱うユーザーにとって有用です。しかしながら、いくつかの面倒な問題も発生します。マシンのユーザーが、潜在的な問題について理解し、それらの問題の発生を防止するために必要な知識を持っていない場合は、非同期書き込みを使用可能にしないことをお勧めします。面倒な問題は以下のとおりです。
<UL>
<LI>たいていの場合、キャッシュ・マネージャーはデフォルトの設定よりも速くアプリケーションに制御を戻します。ただし、必ずそうなることを保証するわけではありません。ユーザーは、必ずしもより高速なパフォーマンスを得られるわけではありません。
</LI><LI>非同期書き込みが失敗した場合、正常に実行されたことを示すコードと共に<B>クローズ</B>のシステム呼び出しが既に戻されているため、非同期書き込みが失敗したことをアプリケーションに通知することができません。
</LI><LI>非同期書き込みは、書き込み操作によってボリュームの割り当て量が超過した場合でも、ユーザーがそのことを認識しない可能性を大きくします。通常、割り当て量を超えたファイルの部分は脱落しますが、次のようなメッセージがそのことを指示します。
<P>
<PRE>   No space left on device
</PRE>
<P>
<P>不充分な割り当て量のために起こるデータの脱落を防止するためには、ファイルをクローズする前に、ファイルが存在するボリュームにこれから書き込むファイルに必要な空きスペースがあるかどうかを検査する必要があります。
</LI></UL>
<P><B>fs storebehind</B> コマンドを発行して非同期書き込みを使用可能にする場合は、キャッシュ・マネージャーがアプリケーション・プログラムに制御を戻すときに、ファイル・サーバーへ書き込むために残っているファイルの K バイト の数値を設定します。この設定は、マシン上で実行されるアプリケーションが操作するすべてのファイルに適用するか、または特定のファイルのみに適用することができます。
<UL>
<LI>すべてのファイルに適用する設定は、マシンに対する<I>デフォルトの非同期保管</I>と呼ばれ、マシンがリブートするまで持続します。たとえば、デフォルトの非同期保管を 10 KB に設定した場合、あるアプリケーションがファイルをクローズするときには、アプリケーションがクローズしたファイルのうちファイル・サーバーに書き込む内容の残りが 10 KB のみになるとすぐに、キャッシュ・マネージャーはそのアプリケーションに制御を戻すことができることを意味します。
</LI><LI>個々のファイルに対する設定は、デフォルトの非同期保管をオーバーライドし、キャッシュ・マネージャーがファイルの特定の情報の追跡に使用する内部テーブル内のファイルに項目が存在する限り、デフォルトの非同期保管を接続します。一般的に、そのような項目はあるアプリケーションがファイルをクローズするか、または完全に終了するまで最低持続します。ただし、そのファイルが活動停止中であり、テーブル内のスロットを空にする必要がある場合は、キャッシュ・マネージャーは自由にその項目をリサイクルすることができます。テーブル内に項目が存在することを確認するためには、ファイルをクローズする直前に <B>fs storebehind</B> コマンドを発行します。
</LI></UL>
<A NAME="IDX7506"></A>
<A NAME="IDX7507"></A>
<P><H3><A NAME="Header_487" HREF="auagd002.htm#ToC_487">デフォルトの非同期保管を設定する方法</A></H3>
<OL TYPE=1>
<LI>まだの場合は、<B>su</B> コマンドを発行し、マシン上でローカル・スーパーユーザー <B>root</B> になります。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>-allfiles</B> 引き数を指定した <B>fs storebehind</B> コマンドを発行する。
<P>
<PRE>   # <B>fs storebehind -allfiles</B>  &lt;<VAR>new default (KB)</VAR>> [<B>-verbose</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>st
</B><DD>は、<B>storebehind</B> の受け入れ可能な省略形です。
<P><DT><B>-allfiles
</B><DD>キャッシュ・マネージャーがファイルをクローズしたアプリケーションに制御を戻すときに、ファイル・サーバーへ書き込むために残っているファイルの K バイトの数値を設定します。
<P><DT><B>-verbose
</B><DD>新しい設定を確認するメッセージを生成します。
</DL>
</LI></OL>
<A NAME="IDX7508"></A>
<A NAME="IDX7509"></A>
<P><H3><A NAME="Header_488" HREF="auagd002.htm#ToC_488">1 つまたは複数のファイルに対して非同期保管を設定する方法</A></H3>
<OL TYPE=1>
<LI><B>fs listacl</B> コマンドを発行して、非同期保管を設定する各ファイルのアクセス制御リスト (ACL) に対する <B>w</B>
(<B>書き込み</B>) 許可を持っていることを確認します。このことについての完全な説明は、<A HREF="auagd020.htm#HDRWQ788">ACL の表示</A>に記載されています。
<P>
<PRE>   % <B>fs listacl</B> <VAR>dir/file path</VAR>
</PRE>
<P>
<P>上記の代替方法として、既にクライアント・マシン上のローカル・スーパーユーザー <B>root</B> になっていない場合は、
<B>su</B> コマンドを発行して登録します。
<P>
<PRE>   % <B>su root</B>
   Password: <VAR>root_password</VAR>
</PRE>
</LI><LI><B>-kbytes</B> および <B>-files</B> 引き数を指定した
<B>fs storebehind</B> コマンドを発行します。
<P>
<PRE>   # <B>fs storebehind -kbytes</B> &lt;<VAR>asynchrony for specified names</VAR>> \
                    <B>-files</B> &lt;<VAR>specific pathnames</VAR>><SUP>+</SUP>  \
                    [<B>-verbose</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>st
</B><DD>は、<B>storebehind</B> の受け入れ可能な省略形です。
<P><DT><B>-kbytes
</B><DD>キャッシュ・マネージャーが、
<B>-files</B> 引き数で指定するファイルをクローズしたアプリケーションに制御を戻すときに、ファイル・サーバーへ書き込むために残っているファイルの K バイトの数値を設定します。
<P><DT><B>-files
</B><DD>デフォルトの設定を上書きする非同期保管を設定する各ファイルを指定します。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。
<P><DT><B>-verbose
</B><DD>新しい設定を確認するメッセージを生成します。
</DL>
</LI></OL>
<A NAME="IDX7510"></A>
<A NAME="IDX7511"></A>
<P><H3><A NAME="Header_489" HREF="auagd002.htm#ToC_489">デフォルトの非同期保管を表示する方法</A></H3>
<OL TYPE=1>
<LI>引き数を全く指定しないか、
<B>-verbose</B> フラグのみを指定した <B>fs storebehind</B> コマンドを発行します。
<P>
<PRE>   % <B>fs storebehind </B> [<B>-verbose</B>]
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>st
</B><DD>は、<B>storebehind</B> の受け入れ可能な省略形です。
<P><DT><B>-verbose
</B><DD>デフォルトの非同期保管を報告する出力を生成します。
</DL>
</LI></OL>
<A NAME="IDX7512"></A>
<A NAME="IDX7513"></A>
<P><H3><A NAME="Header_490" HREF="auagd002.htm#ToC_490">1 つまたは複数のファイルに対して非同期保管を表示する方法</A></H3>
<OL TYPE=1>
<LI><B>-files</B> 引き数のみを指定する <B>fs storebehind</B> コマンドを発行します。
<P>
<PRE>   % <B>fs storebehind</B> <B>-files</B>
&lt;<VAR>specific pathnames</VAR>><SUP> +</SUP>
</PRE>
<P>
<P>ここで、
<P>
<DL>
<P><DT><B>st
</B><DD>は、<B>storebehind</B> の受け入れ可能な省略形です。
<P><DT><B>-files
</B><DD>非同期保管を表示する各ファイルを指定します。パス名の一部は、現行作業ディレクトリーとの関連で解釈されます。
</DL>
</LI></OL>
<P>出力は各ファイルを別々にリストします。指定したファイルに対して以前に値を設定している場合は、出力は次の内容を報告します。
<PRE>   Will store up to <VAR>y</VAR> kbytes of <VAR>file</VAR> asynchronously.
   Default store asynchrony is <VAR>x</VAR> kbytes.
</PRE>
<P>デフォルトの非同期保管がファイルに適用される場合は
(ファイルに対して <B>-kbytes</B> 値を設定しなかったため)、出力は次の内容を報告します。
<PRE>   Will store <VAR>file</VAR> according to default.
   Default store asynchrony is <VAR>x</VAR> kbytes.
</PRE>
<P><HR><B>&#91; <A HREF="#Top_Of_Page">ページのトップ</A> &#124; <A HREF="auagd014.htm">前ページ</A> &#124; <A HREF="auagd016.htm">次ページ</A> &#124; <A HREF="auagd002.htm#ToC">目次</A> &#124; <A HREF="auagd026.htm#HDRINDEX">索引</A> &#93;</B>
<!-- Begin Footer Records  ========================================== -->
<P><HR><B>
<br>(C) <A HREF="http://www.ibm.com/">IBM Corporation 2000.</A>  All Rights Reserved<!-- 991224 -->
</B>
<!-- End Footer Records  ============================================ -->
<A NAME="Bot_Of_Page"></A>
</BODY></HTML>
